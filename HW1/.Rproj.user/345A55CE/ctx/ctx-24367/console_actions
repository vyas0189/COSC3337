{
    "data" : [
        "+ ",
        "            method=\"anova\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRegression tree:\nrpart(formula = B ~ ., data = bus_test, method = \"anova\")\n\nVariables actually used in tree construction:\n[1] V10 V12 V15 V18 V6 \n\nRoot node error: 32.612/170 = 0.19183\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.286683      0   1.00000 1.00440 0.084850\n2 0.082370      2   0.42663 0.50758 0.092752\n3 0.062368      3   0.34426 0.53386 0.100953\n4 0.031354      4   0.28190 0.51287 0.097531\n5 0.010000      5   0.25054 0.48858 0.088495\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"anova\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.28668262      0 1.0000000 1.0044003 0.08485012\n2 0.08236987      2 0.4266348 0.5075835 0.09275171\n3 0.06236768      3 0.3442649 0.5338613 0.10095261\n4 0.03135378      4 0.2818972 0.5128679 0.09753054\n5 0.01000000      5 0.2505434 0.4885811 0.08849503\n\nVariable importance\nV12  V3  V6 V11  V7  V8  V9 V10 V18  V1  V2 V13 V14  V4 V16 V15  V5 \n 14  10  10  10  10  10   8   7   7   4   2 ",
        "  2   1   1   1   1   1 \n\nNode number 1: 170 observations,    complexity param=0.2866826\n  mean=0.2588235, MSE=0.1918339 \n  left son=2 (95 obs) right son=3 (75 obs)\n  Primary splits:\n      V6  < -0.2319769 to the right, improve=0.2807245, (0 missing)\n      V14 < 0.806444   to the left,  improve=0.2088595, (0 missing)\n      V18 < -0.8243789 to the right, improve=0.1836505, (0 missing)\n      V3  < -0.4494587 to the right, improve=0.1435168, (0 missing)\n      V11 < 1.747889   to the left,  improve=0.1414141, (0 missing)",
        "\n  Surrogate splits:\n      V3  < -0.5445668 to the right, agree=0.776, adj=0.493, (0 split)\n      V10 < 0.03452701 to the right, agree=0.753, adj=0.440, (0 split)\n      V18 < -0.6899486 to the right, agree=0.747, adj=0.427, (0 split)\n      V12 < -0.5060276 to the right, agree=0.735, adj=0.400, (0 split)\n      V1  < -0.6288789 to the right, agree=0.724, adj=0.373, (0 split)\n\nNode number 2: 95 observations,    complexity param=0.06236768\n  mean=0.05263158, MSE=0.0498615 \n  left son=4 (88 obs) right son=5 (7 obs)",
        "\n  Primary splits:\n      V18 < -0.6899486 to the right, improve=0.4293831, (0 missing)\n      V3  < -0.6079721 to the right, improve=0.3214286, (0 missing)\n      V14 < 0.405748   to the left,  improve=0.2847059, (0 missing)\n      V1  < -0.6288789 to the right, improve=0.2540284, (0 missing)\n      V17 < -0.8813544 to the right, improve=0.1916507, (0 missing)\n  Surrogate splits:\n      V4  < -1.148443  to the right, agree=0.968, adj=0.571, (0 split)\n      V5  < -1.165512  to the right, agree=0.958, adj=0.429, (0 split)",
        "\n      V14 < 0.6728787  to the left,  agree=0.958, adj=0.429, (0 split)\n      V1  < -1.296803  to the right, agree=0.947, adj=0.286, (0 split)\n      V3  < -1.083512  to the right, agree=0.947, adj=0.286, (0 split)\n\nNode number 3: 75 observations,    complexity param=0.2866826\n  mean=0.52, MSE=0.2496 \n  left son=6 (24 obs) right son=7 (51 obs)\n  Primary splits:\n      V12 < -0.8031538 to the left,  improve=0.5098039, (0 missing)\n      V8  < 0.840574   to the right, improve=0.4791667, (0 missing)\n      V11 < -0.8162264 to the left,  improve=0.4791667, (0 missing)",
        "\n      V2  < -0.5448582 to the left,  improve=0.4617028, (0 missing)\n      V7  < -0.7922774 to the left,  improve=0.4615385, (0 missing)\n  Surrogate splits:\n      V7  < -0.7922774 to the left,  agree=0.987, adj=0.958, (0 split)\n      V8  < 0.7125586  to the right, agree=0.987, adj=0.958, (0 split)\n      V11 < -0.8162264 to the left,  agree=0.987, adj=0.958, (0 split)\n      V9  < -0.8034842 to the left,  agree=0.933, adj=0.792, (0 split)\n      V3  < -1.337134  to the left,  agree=0.840, adj=0.500, (0 split)\n",
        "\nNode number 4: 88 observations\n  mean=0.01136364, MSE=0.0112345 \n\nNode number 5: 7 observations\n  mean=0.5714286, MSE=0.244898 \n\nNode number 6: 24 observations\n  mean=0, MSE=0 \n\nNode number 7: 51 observations,    complexity param=0.08236987\n  mean=0.7647059, MSE=0.1799308 \n  left son=14 (10 obs) right son=15 (41 obs)\n  Primary splits:\n      V10 < -0.9299492 to the left,  improve=0.2927298, (0 missing)\n      V2  < -0.7069363 to the left,  improve=0.2071417, (0 missing)\n      V15 < 0.4316346  to the right, improve=0.1803002, (0 missing)",
        "\n      V3  < -0.4494587 to the right, improve=0.1453297, (0 missing)\n      V14 < -0.1285132 to the left,  improve=0.1453297, (0 missing)\n  Surrogate splits:\n      V2  < -1.031092  to the left,  agree=0.961, adj=0.8, (0 split)\n      V13 < -1.066269  to the left,  agree=0.922, adj=0.6, (0 split)\n      V16 < 0.6606819  to the right, agree=0.882, adj=0.4, (0 split)\n      V18 < 0.7887851  to the right, agree=0.863, adj=0.3, (0 split)\n      V14 < -1.06347   to the left,  agree=0.843, adj=0.2, (0 split)\n\nNode number ",
        "14: 10 observations\n  mean=0.3, MSE=0.21 \n\nNode number 15: 41 observations,    complexity param=0.03135378\n  mean=0.8780488, MSE=0.1070791 \n  left son=30 (10 obs) right son=31 (31 obs)\n  Primary splits:\n      V15 < 0.2283145  to the right, improve=0.2329032, (0 missing)\n      V3  < -0.4494587 to the right, improve=0.1960784, (0 missing)\n      V7  < -0.4614003 to the right, improve=0.1608187, (0 missing)\n      V11 < -0.2906623 to the right, improve=0.1608187, (0 missing)\n      V12 < -0.5116872 to the right, improve=0.1608187, (0 missing)",
        "\n  Surrogate splits:\n      V1  < 1.678494   to the right, agree=0.805, adj=0.2, (0 split)\n      V10 < 1.136785   to the right, agree=0.780, adj=0.1, (0 split)\n\nNode number 30: 10 observations\n  mean=0.6, MSE=0.24 \n\nNode number 31: 31 observations\n  mean=0.9677419, MSE=0.03121748 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"classification tree for Bus\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n     0 0.0113636363636364 0.3 0.571428571428571 0.6 0.967741935483871\n  0 24                 87   7                 3   4                 1\n  1  0                  1   3                 4   6                30\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(B~.,",
        "+ ",
        "            method=\"class\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = B ~ ., data = bus_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V10 V12 V18 V6 \n\nRoot node error: 44/170 = 0.25882\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.306818      0   1.00000 1.00000 0.129788\n2 0.090909      2   0.38636 0.50000 0.099464\n3 0.022727      3   0.29545 0.45455 0.095474\n4 0.010000      4   0.27273 0.47727 0.097505\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"class\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.30681818      0 1.0000000 1.0000000 0.12978798\n2 0.09090909      2 0.3863636 0.5000000 0.09946380\n3 0.02272727      3 0.2954545 0.4545455 0.09547364\n4 0.01000000      4 0.2727273 0.4772727 0.09750472\n\nVariable importance\nV12  V3  V6 V11  V7  V8  V9 V18 V10  V1  V2 V13 V14  V4 V16  V5 \n 14  11  10  10  10  10   8   7   7   4   2   2   2   1   1   1 \n\nNode number 1: 170 observations",
        ",    complexity param=0.3068182\n  predicted class=0  expected loss=0.2588235  P(node) =1\n    class counts:   126    44\n   probabilities: 0.741 0.259 \n  left son=2 (95 obs) right son=3 (75 obs)\n  Primary splits:\n      V6  < -0.2319769 to the right, improve=18.309850, (0 missing)\n      V14 < 0.806444   to the left,  improve=13.622560, (0 missing)\n      V18 < -0.8243789 to the right, improve=11.978340, (0 missing)\n      V3  < -0.4494587 to the right, improve= 9.360672, (0 missing)\n      V8  < -1.463703  to the right, improve= 9.223529, (0 missing)",
        "\n  Surrogate splits:\n      V3  < -0.5445668 to the right, agree=0.776, adj=0.493, (0 split)\n      V10 < 0.03452701 to the right, agree=0.753, adj=0.440, (0 split)\n      V18 < -0.6899486 to the right, agree=0.747, adj=0.427, (0 split)\n      V12 < -0.5060276 to the right, agree=0.735, adj=0.400, (0 split)\n      V1  < -0.6288789 to the right, agree=0.724, adj=0.373, (0 split)\n\nNode number 2: 95 observations,    complexity param=0.02272727\n  predicted class=0  expected loss=0.05263158  P(node) =0.5588235\n    class counts:    90     5\n   probabilities: 0.947 0.053",
        " \n  left son=4 (88 obs) right son=5 (7 obs)\n  Primary splits:\n      V18 < -0.6899486 to the right, improve=4.067840, (0 missing)\n      V3  < -0.6079721 to the right, improve=3.045113, (0 missing)\n      V14 < 0.405748   to the left,  improve=2.697214, (0 missing)\n      V1  < -0.6288789 to the right, improve=2.406585, (0 missing)\n      V17 < -0.8813544 to the right, improve=1.815638, (0 missing)\n  Surrogate splits:\n      V4  < -1.148443  to the right, agree=0.968, adj=0.571, (0 split)\n      V5  < -1.165512  to the right, agree=0.958, adj=0.429, (0 split)",
        "\n      V14 < 0.6728787  to the left,  agree=0.958, adj=0.429, (0 split)\n      V1  < -1.296803  to the right, agree=0.947, adj=0.286, (0 split)\n      V3  < -1.083512  to the right, agree=0.947, adj=0.286, (0 split)\n\nNode number 3: 75 observations,    complexity param=0.3068182\n  predicted class=1  expected loss=0.48  P(node) =0.4411765\n    class counts:    36    39\n   probabilities: 0.480 0.520 \n  left son=6 (24 obs) right son=7 (51 obs)\n  Primary splits:\n      V12 < -0.8031538 to the left,  improve=19.08706, (0 missing)",
        "\n      V8  < 0.840574   to the right, improve=17.94000, (0 missing)\n      V11 < -0.8162264 to the left,  improve=17.94000, (0 missing)\n      V2  < -0.5448582 to the left,  improve=17.28615, (0 missing)\n      V7  < -0.7922774 to the left,  improve=17.28000, (0 missing)\n  Surrogate splits:\n      V7  < -0.7922774 to the left,  agree=0.987, adj=0.958, (0 split)\n      V8  < 0.7125586  to the right, agree=0.987, adj=0.958, (0 split)\n      V11 < -0.8162264 to the left,  agree=0.987, adj=0.958, (0 split)\n      V9  < -0.8034842 to the left,  agree=0.933, adj=0.792, (0 split)",
        "\n      V3  < -1.337134  to the left,  agree=0.840, adj=0.500, (0 split)\n\nNode number 4: 88 observations\n  predicted class=0  expected loss=0.01136364  P(node) =0.5176471\n    class counts:    87     1\n   probabilities: 0.989 0.011 \n\nNode number 5: 7 observations\n  predicted class=1  expected loss=0.4285714  P(node) =0.04117647\n    class counts:     3     4\n   probabilities: 0.429 0.571 \n\nNode number 6: 24 observations\n  predicted class=0  expected loss=0  P(node) =0.1411765\n    class counts:    24     0\n   probabilities: 1.000 0.000",
        " \n\nNode number 7: 51 observations,    complexity param=0.09090909\n  predicted class=1  expected loss=0.2352941  P(node) =0.3\n    class counts:    12    39\n   probabilities: 0.235 0.765 \n  left son=14 (10 obs) right son=15 (41 obs)\n  Primary splits:\n      V10 < -0.9299492 to the left,  improve=5.372453, (0 missing)\n      V2  < -0.7069363 to the left,  improve=3.801659, (0 missing)\n      V15 < 0.4316346  to the right, improve=3.309039, (0 missing)\n      V3  < -0.4494587 to the right, improve=2.667227, (0 missing)",
        "\n      V14 < -0.1285132 to the left,  improve=2.667227, (0 missing)\n  Surrogate splits:\n      V2  < -1.031092  to the left,  agree=0.961, adj=0.8, (0 split)\n      V13 < -1.066269  to the left,  agree=0.922, adj=0.6, (0 split)\n      V16 < 0.6606819  to the right, agree=0.882, adj=0.4, (0 split)\n      V18 < 0.7887851  to the right, agree=0.863, adj=0.3, (0 split)\n      V14 < -1.06347   to the left,  agree=0.843, adj=0.2, (0 split)\n\nNode number 14: 10 observations\n  predicted class=0  expected loss=0.3  P(node) =0.05882353\n    class counts:     7     3\n   probabilities: 0.700 0.300",
        " \n\nNode number 15: 41 observations\n  predicted class=1  expected loss=0.1219512  P(node) =0.2411765\n    class counts:     5    36\n   probabilities: 0.122 0.878 \n\n",
        "> ",
        "",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification Tree for B\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test, type=\"class\")",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n      0   1\n  0 118   8\n  1   4  40\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(B~.,",
        "+ ",
        "            method=\"poisson\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRates regression tree:\nrpart(formula = B ~ ., data = bus_test, method = \"poisson\")\n\nVariables actually used in tree construction:\n[1] V12 V14 V3  V6 \n\nRoot node error: 118.94/170 = 0.69966\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.328054      0   1.00000 1.00832 0.034652\n2 0.281472      1   0.67195 0.75590 0.083797\n3 0.094285      2   0.39047 0.56229 0.106622\n4 0.027056      4   0.20190 0.63030 0.128222\n5 0.010000      5   0.17485 0.62704 0.128200\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"poisson\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.32805351      0 1.0000000 1.0083189 0.03465219\n2 0.28147178      1 0.6719465 0.7559014 0.08379659\n3 0.09428514      2 0.3904747 0.5622933 0.10662248\n4 0.02705634      4 0.2019044 0.6302994 0.12822165\n5 0.01000000      5 0.1748481 0.6270394 0.12819950\n\nVariable importance\n V7  V3  V9 V12  V6 V11  V8 V10  V2  V5 V14 V18 V17  V4  V1 \n 15  13  13  11  10  10   8   6   5   4   2   1 ",
        "  1   1   1 \n\nNode number 1: 170 observations,    complexity param=0.3280535\n  events=44,  estimated rate=0.2588235 , mean deviance=0.6996563 \n  left son=2 (72 obs) right son=3 (98 obs)\n  Primary splits:\n      V6  < -0.01464306 to the right, improve=39.54425, (0 missing)\n      V11 < -0.8003002  to the left,  improve=21.59954, (0 missing)\n      V12 < -0.800324   to the left,  improve=20.94036, (0 missing)\n      V14 < 0.806444    to the left,  improve=20.62782, (0 missing)\n      V18 < -0.8243789  to the right, improve=19.63493, (0 missing)",
        "\n  Surrogate splits:\n      V10 < 0.03452701  to the right, agree=0.841, adj=0.625, (0 split)\n      V3  < -0.03732373 to the right, agree=0.835, adj=0.611, (0 split)\n      V2  < 0.2655322   to the right, agree=0.782, adj=0.486, (0 split)\n      V7  < 0.03491524  to the right, agree=0.771, adj=0.458, (0 split)\n      V9  < -0.4177024  to the right, agree=0.771, adj=0.458, (0 split)\n\nNode number 2: 72 observations,    complexity param=0.02705634\n  events=1,  estimated rate=0.02636309 , mean deviance=0.1259426 \n  left son=",
        "4 (65 obs) right son=5 (7 obs)\n  Primary splits:\n      V6  < 0.6373584   to the left,  improve=4.661512, (0 missing)\n      V10 < -0.2754832  to the right, improve=4.661512, (0 missing)\n      V3  < -0.3543506  to the right, improve=4.394449, (0 missing)\n      V18 < -0.2866576  to the right, improve=4.394449, (0 missing)\n      V1  < -0.5074382  to the right, improve=4.158883, (0 missing)\n  Surrogate splits:\n      V4 < 1.749486    to the left,  agree=0.931, adj=0.286, (0 split)\n      V5 < 0.9895915   to the left,  agree=0.931, adj=0.286, (0 split)",
        "\n\nNode number 3: 98 observations,    complexity param=0.2814718\n  events=43,  estimated rate=0.43195 , mean deviance=0.7230052 \n  left son=6 (33 obs) right son=7 (65 obs)\n  Primary splits:\n      V12 < -0.800324   to the left,  improve=35.30990, (0 missing)\n      V7  < -0.8524368  to the left,  improve=31.42954, (0 missing)\n      V8  < 0.840574    to the right, improve=31.42954, (0 missing)\n      V11 < -0.8003002  to the left,  improve=31.42954, (0 missing)\n      V2  < -0.5448582  to the left,  improve=21.21730, (0 missing)",
        "\n  Surrogate splits:\n      V7  < -0.7922774  to the left,  agree=0.990, adj=0.970, (0 split)\n      V8  < 0.7125586   to the right, agree=0.990, adj=0.970, (0 split)\n      V11 < -0.8003002  to the left,  agree=0.969, adj=0.909, (0 split)\n      V9  < -0.8034842  to the left,  agree=0.929, adj=0.788, (0 split)\n      V3  < -0.9567017  to the left,  agree=0.796, adj=0.394, (0 split)\n\nNode number 4: 65 observations\n  events=0,  estimated rate=0.01452145 , mean deviance=0.0290429 \n\nNode number 5: 7 observations\n  events=1,  estimated rate=0.1841004 , mean deviance=0.5659934",
        " \n\nNode number 6: 33 observations\n  events=0,  estimated rate=0.027127 , mean deviance=0.05425401 \n\nNode number 7: 65 observations,    complexity param=0.09428514\n  events=43,  estimated rate=0.6389439 , mean deviance=0.5474681 \n  left son=14 (32 obs) right son=15 (33 obs)\n  Primary splits:\n      V14 < -0.1285132  to the left,  improve=6.395034, (0 missing)\n      V10 < -0.8955036  to the left,  improve=5.746932, (0 missing)\n      V3  < -0.5445668  to the right, improve=5.429323, (0 missing)\n      V2  < -1.031092   to the left,  improve=4.703332, (0 missing)",
        "\n      V6  < -0.2319769  to the right, improve=4.587401, (0 missing)\n  Surrogate splits:\n      V18 < -0.7571637  to the right, agree=0.908, adj=0.812, (0 split)\n      V17 < -0.5568871  to the right, agree=0.892, adj=0.781, (0 split)\n      V4  < -0.4911809  to the right, agree=0.754, adj=0.500, (0 split)\n      V1  < -0.7503195  to the right, agree=0.723, adj=0.438, (0 split)\n      V5  < -0.4682728  to the right, agree=0.708, adj=0.406, (0 split)\n\nNode number 14: 32 observations,    complexity param=0.09428514",
        "\n  events=13,  estimated rate=0.3903676 , mean deviance=0.7325267 \n  left son=28 (16 obs) right son=29 (16 obs)\n  Primary splits:\n      V3  < -0.4494587  to the right, improve=18.021830, (0 missing)\n      V5  < 0.5458937   to the left,  improve=10.740090, (0 missing)\n      V6  < -0.4493107  to the right, improve= 6.542553, (0 missing)\n      V11 < -0.1314004  to the right, improve= 5.193881, (0 missing)\n      V7  < -0.386201   to the right, improve= 4.903542, (0 missing)\n  Surrogate splits:\n      V5  < 0.5458937   to the left,  agree=0.844, adj=0.688, (0 split)",
        "\n      V7  < -0.4614003  to the right, agree=0.781, adj=0.562, (0 split)\n      V9  < -0.4177024  to the right, agree=0.781, adj=0.562, (0 split)\n      V11 < -0.3065885  to the right, agree=0.781, adj=0.562, (0 split)\n      V12 < -0.3617092  to the right, agree=0.781, adj=0.562, (0 split)\n\nNode number 15: 33 observations\n  events=30,  estimated rate=0.8409371 , mean deviance=0.1786713 \n\nNode number 28: 16 observations\n  events=0,  estimated rate=0.05034325 , mean deviance=0.1006865 \n\nNode number 29: 16 observations",
        "\n  events=13,  estimated rate=0.7048055 , mean deviance=0.3530903 \n\n",
        "> ",
        "",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification Tree for B\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n    0.0145214521452145 0.0271270036991369 0.0503432494279176 0.184100418410042 0.704805491990847 0.840937114673243\n  0                 65                 33                 16                 6                 3                 3\n  1                  0                  0                  0                 1                13                30\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "van_data <- select(zscore,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18, V)",
        "> ",
        "set.seed(123)",
        "> ",
        "sample <- sample.split(van_data$V, SplitRatio=0.8)",
        "> ",
        "",
        "> ",
        "van_train = subset(van_data, sample == TRUE)",
        "> ",
        "van_test = subset(van_data, sample == FALSE)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"anova\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRegression tree:\nrpart(formula = V ~ ., data = van_test, method = \"anova\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V4  V6  V7 \n\nRoot node error: 30.533/169 = 0.18067\n\nn= 169 \n\n        CP nsplit rel error  xerror     xstd\n1 0.333434      0   1.00000 1.00569 0.095836\n2 0.174691      1   0.66657 0.74523 0.083890\n3 0.108528      2   0.49187 0.68511 0.100030\n4 0.035217      3   0.38335 0.50197 0.096360\n5 0.013399      5   0.31291 0.48978 0.101074\n6 0.010000      6   0.29951 0.49393 0.100990",
        "\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"anova\")\n  n= 169 \n\n          CP nsplit rel error    xerror       xstd\n1 0.33343426      0 1.0000000 1.0056922 0.09583636\n2 0.17469118      1 0.6665657 0.7452283 0.08389049\n3 0.10852801      2 0.4918746 0.6851064 0.10003007\n4 0.03521724      3 0.3833465 0.5019685 0.09636000\n5 0.01339852      5 0.3129121 0.4897834 0.10107408\n6 0.01000000      6 0.2995135 0.4939281 0.10099013\n\nVariable importance\nV11 V12  V8  V7  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 ",
        "\n 15  12  12  12  11   8   7   5   4   4   4   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.3334343\n  mean=0.2366864, MSE=0.1806659 \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=0.3334343, (0 missing)\n      V8  < 0.2004969   to the left,  improve=0.2721792, (0 missing)\n      V12 < -0.3843474  to the right, improve=0.2301606, (0 missing)\n      V4  < -0.222301   to the right, improve=0.2271689, (0 missing)\n      V7  < -0.7321179  to the right, improve=0.2155511, (0 missing)",
        "\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations,    complexity param=0.01339852\n  mean=0.03030303, MSE=0.02938476 \n  left son=4 (81 obs) right son=",
        "5 (18 obs)\n  Primary splits:\n      V4  < -0.2521765  to the right, improve=0.14062500, (0 missing)\n      V8  < 0.2004969   to the left,  improve=0.12343750, (0 missing)\n      V17 < -0.5568871  to the right, improve=0.09765625, (0 missing)\n      V11 < -0.2588099  to the right, improve=0.09250000, (0 missing)\n      V12 < -0.3843474  to the right, improve=0.08333333, (0 missing)\n  Surrogate splits:\n      V1  < -0.7503195  to the right, agree=0.939, adj=0.667, (0 split)\n      V8  < 0.3285124   to the left,  agree=0.929, adj=0.611, (0 split)",
        "\n      V3  < -0.6079721  to the right, agree=0.919, adj=0.556, (0 split)\n      V12 < -0.4437726  to the right, agree=0.919, adj=0.556, (0 split)\n      V11 < -0.4499242  to the right, agree=0.899, adj=0.444, (0 split)\n\nNode number 3: 70 observations,    complexity param=0.1746912\n  mean=0.5285714, MSE=0.2491837 \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=0.3057851, (0 missing)\n      V6  < -0.01464306 to the left,  improve=0.2432432, (0 missing)\n",
        "      V14 < 0.9400093   to the right, improve=0.2335145, (0 missing)\n      V1  < -1.236082   to the left,  improve=0.1867023, (0 missing)\n      V18 < -1.496531   to the left,  improve=0.1867023, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)",
        "\n\nNode number 4: 81 observations\n  mean=0, MSE=0 \n\nNode number 5: 18 observations\n  mean=0.1666667, MSE=0.1388889 \n\nNode number 6: 15 observations\n  mean=0, MSE=0 \n\nNode number 7: 55 observations,    complexity param=0.108528\n  mean=0.6727273, MSE=0.2201653 \n  left son=14 (11 obs) right son=15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=0.2736486, (0 missing)\n      V10 < -0.3099288  to the left,  improve=0.2193980, (0 missing)\n      V6  < -0.01464306 to the left,  improve=0.1824324, (0 missing)",
        "\n      V2  < -1.355249   to the left,  improve=0.1084835, (0 missing)\n      V7  < -0.4614003  to the left,  improve=0.1081081, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)\n\nNode number 14: 11 observations\n  mean=0.1818182, MSE=0.1487603 \n\nNode number 15: 44 observations,    complexity param=0.03521724\n  mean=0.7954545, MSE=0.1627066 \n  left son=30 (31 obs) right son=31 (13 obs)\n",
        "  Primary splits:\n      V6  < -0.01464306 to the left,  improve=0.10783410, (0 missing)\n      V10 < -0.3099288  to the left,  improve=0.10779620, (0 missing)\n      V4  < -0.9841276  to the right, improve=0.08217312, (0 missing)\n      V7  < -0.5967591  to the left,  improve=0.07563025, (0 missing)\n      V12 < -0.6192186  to the left,  improve=0.07563025, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)",
        "\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.03521724\n  mean=0.7096774, MSE=0.2060354 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=0.2158335, (0 missing)\n      V12 < -0.9220043  to the right, improve=0.2158335, (0 missing)",
        "\n      V8  < 0.9685894   to the left,  improve=0.1737603, (0 missing)\n      V13 < -0.7590161  to the right, improve=0.1414983, (0 missing)\n      V4  < -0.8496876  to the right, improve=0.1347687, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)",
        "\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)\n\nNode number 31: 13 observations\n  mean=1, MSE=0 \n\nNode number 60: 13 observations\n  mean=0.4615385, MSE=0.2485207 \n\nNode number 61: 18 observations\n  mean=0.8888889, MSE=0.09876543 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n     0 0.166666666666667 0.181818181818182 0.461538461538462 0.888888888888889  1\n  0 96                15                 9                 7                 2  0\n  1  0                 3                 2                 6                16 13\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.5857988\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"class\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V6  V7 \n\nRoot node error: 40/169 = 0.23669\n\nn= 169 \n\n      CP nsplit rel error xerror    xstd\n1 0.2375      0     1.000  1.000 0.13814\n2 0.1750      2     0.525  0.750 0.12418\n3 0.0125      3     0.350  0.475 0.10266\n4 0.0100      5     0.325  0.525 0.10721\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n  n= 169 \n\n      CP nsplit rel error xerror      xstd\n1 0.2375      0     1.000  1.000 0.1381407\n2 0.1750      2     0.525  0.750 0.1241837\n3 0.0125      3     0.350  0.475 0.1026642\n4 0.0100      5     0.325  0.525 0.1072105\n\nVariable importance\nV11 V12  V7  V8  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 \n 15  12  12  12  11   8   7   5   4   4   3   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.2375\n  predicted class=0  expected loss=0.2366864  P(node) =1\n    class counts:   129    40\n   probabilities: 0.763 0.237",
        " \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=20.36119, (0 missing)\n      V8  < 0.2004969   to the left,  improve=16.62064, (0 missing)\n      V12 < -0.3843474  to the right, improve=14.05478, (0 missing)\n      V4  < -0.222301   to the right, improve=13.87209, (0 missing)\n      V7  < -0.7321179  to the right, improve=13.16265, (0 missing)\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)",
        "\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations\n  predicted class=0  expected loss=0.03030303  P(node) =0.5857988\n    class counts:    96     3\n   probabilities: 0.970 0.030 \n\nNode number 3: 70 observations,    complexity param=0.2375\n  predicted class=1  expected loss=0.4714286  P(node) =0.4142012\n    class counts:    33    37\n   probabilities: 0.471 0.529",
        " \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=10.667530, (0 missing)\n      V6  < -0.01464306 to the left,  improve= 8.485714, (0 missing)\n      V14 < 0.9400093   to the right, improve= 8.146320, (0 missing)\n      V1  < -1.236082   to the left,  improve= 6.513245, (0 missing)\n      V18 < -1.496531   to the left,  improve= 6.513245, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)",
        "\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)\n\nNode number 6: 15 observations\n  predicted class=0  expected loss=0  P(node) =0.0887574\n    class counts:    15     0\n   probabilities: 1.000 0.000 \n\nNode number 7: 55 observations,    complexity param=0.175\n  predicted class=1  expected loss=0.3272727  P(node) =0.3254438\n    class counts:    18    37\n   probabilities: 0.327 0.673 \n  left son=14 (11 obs) right son=",
        "15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.627273, (0 missing)\n      V10 < -0.3099288  to the left,  improve=5.313420, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.418182, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.627273, (0 missing)\n      V7  < -0.4614003  to the left,  improve=2.618182, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)",
        "\n\nNode number 14: 11 observations\n  predicted class=0  expected loss=0.1818182  P(node) =0.06508876\n    class counts:     9     2\n   probabilities: 0.818 0.182 \n\nNode number 15: 44 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2045455  P(node) =0.260355\n    class counts:     9    35\n   probabilities: 0.205 0.795 \n  left son=30 (31 obs) right son=31 (13 obs)\n  Primary splits:\n      V6  < -0.01464306 to the left,  improve=1.543988, (0 missing)\n      V10 < -0.3099288  to the left,  improve=1.543445, (0 missing)",
        "\n      V4  < -0.9841276  to the right, improve=1.176570, (0 missing)\n      V7  < -0.5967591  to the left,  improve=1.082888, (0 missing)\n      V12 < -0.6192186  to the left,  improve=1.082888, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)",
        "\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2903226  P(node) =0.183432\n    class counts:     9    22\n   probabilities: 0.290 0.710 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=2.757100, (0 missing)\n      V12 < -0.9220043  to the right, improve=2.757100, (0 missing)\n      V8  < 0.9685894   to the left,  improve=2.219648, (0 missing)",
        "\n      V13 < -0.7590161  to the right, improve=1.807527, (0 missing)\n      V4  < -0.8496876  to the right, improve=1.721562, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)",
        "\n\nNode number 31: 13 observations\n  predicted class=1  expected loss=0  P(node) =0.07692308\n    class counts:     0    13\n   probabilities: 0.000 1.000 \n\nNode number 60: 13 observations\n  predicted class=0  expected loss=0.4615385  P(node) =0.07692308\n    class counts:     7     6\n   probabilities: 0.538 0.462 \n\nNode number 61: 18 observations\n  predicted class=1  expected loss=0.1111111  P(node) =0.1065089\n    class counts:     2    16\n   probabilities: 0.111 0.889 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test, type = \"class\")",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n      0   1\n  0 127   2\n  1  11  29\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.9230769\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"poisson\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRates regression tree:\nrpart(formula = V ~ ., data = van_test, method = \"poisson\")\n\nVariables actually used in tree construction:\n[1] V1  V14 V16 V6  V8 \n\nRoot node error: 115.28/169 = 0.68214\n\nn= 169 \n\n        CP nsplit rel error  xerror     xstd\n1 0.420630      0   1.00000 1.01266 0.043694\n2 0.169683      1   0.57937 0.67150 0.080948\n3 0.056958      2   0.40969 0.56276 0.091641\n4 0.053347      3   0.35273 0.54142 0.106402\n5 0.043708      4   0.29938 0.54109 0.106559\n6 0.010000      6   0.21197 0.49843 0.105466",
        "\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"poisson\")\n  n= 169 \n\n          CP nsplit rel error    xerror       xstd\n1 0.42062963      0 1.0000000 1.0126597 0.04369370\n2 0.16968326      1 0.5793704 0.6714964 0.08094807\n3 0.05695812      2 0.4096871 0.5627635 0.09164148\n4 0.05334726      3 0.3527290 0.5414230 0.10640154\n5 0.04370757      4 0.2993817 0.5410929 0.10655879\n6 0.01000000      6 0.2119666 0.4984291 0.10546575\n\nVariable importance\n V8 V12  V4  V7  V9 V11 V14 V18 V17  V1  V3 V16 V10 \n 15 ",
        " 15  14  13  12  12   5   4   4   3   2   2   1 \n\nNode number 1: 169 observations,    complexity param=0.4206296\n  events=40,  estimated rate=0.2366864 , mean deviance=0.6821393 \n  left son=2 (79 obs) right son=3 (90 obs)\n  Primary splits:\n      V8  < 0.2004969   to the left,  improve=50.40712, (0 missing)\n      V11 < -0.4499242  to the right, improve=48.38343, (0 missing)\n      V12 < -0.3843474  to the right, improve=44.41502, (0 missing)\n      V4  < 0.04657903  to the right, improve=42.78231, (0 missing)\n",
        "      V7  < -0.2508422  to the right, improve=41.18226, (0 missing)\n  Surrogate splits:\n      V12 < -0.4607513  to the right, agree=0.976, adj=0.949, (0 split)\n      V11 < -0.2588099  to the right, agree=0.970, adj=0.937, (0 split)\n      V7  < -0.2508422  to the right, agree=0.935, adj=0.861, (0 split)\n      V4  < -0.1774876  to the right, agree=0.923, adj=0.835, (0 split)\n      V9  < -0.4177024  to the right, agree=0.905, adj=0.797, (0 split)\n\nNode number 2: 79 observations\n  events=0,  estimated rate=0.01201562 , mean deviance=0.02403124",
        " \n\nNode number 3: 90 observations,    complexity param=0.1696833\n  events=40,  estimated rate=0.4351287 , mean deviance=0.7210249 \n  left son=6 (21 obs) right son=7 (69 obs)\n  Primary splits:\n      V14 < 1.073575    to the right, improve=21.25625, (0 missing)\n      V17 < -1.368055   to the left,  improve=21.25625, (0 missing)\n      V1  < -1.357523   to the left,  improve=13.52611, (0 missing)\n      V18 < -1.496531   to the left,  improve=13.25813, (0 missing)\n      V6  < -0.01464306 to the left,  improve=12.70698, (0 missing)",
        "\n  Surrogate splits:\n      V18 < -1.496531   to the left,  agree=0.944, adj=0.762, (0 split)\n      V17 < -1.205822   to the left,  agree=0.933, adj=0.714, (0 split)\n      V4  < -1.357572   to the left,  agree=0.833, adj=0.286, (0 split)\n      V1  < -1.478964   to the left,  agree=0.811, adj=0.190, (0 split)\n\nNode number 6: 21 observations\n  events=0,  estimated rate=0.03964321 , mean deviance=0.07928642 \n\nNode number 7: 69 observations,    complexity param=0.05695812\n  events=40,  estimated rate=0.5599181 , mean deviance=0.6328388",
        " \n  left son=14 (10 obs) right son=15 (59 obs)\n  Primary splits:\n      V1  < -1.236082   to the left,  improve=6.722882, (0 missing)\n      V16 < 0.5487154   to the right, improve=6.660775, (0 missing)\n      V6  < -0.01464306 to the left,  improve=6.623704, (0 missing)\n      V10 < -1.343296   to the left,  improve=5.622647, (0 missing)\n      V7  < -0.4614003  to the left,  improve=4.224364, (0 missing)\n\nNode number 14: 10 observations\n  events=1,  estimated rate=0.1405975 , mean deviance=0.4735658 \n\nNode number ",
        "15: 59 observations,    complexity param=0.05334726\n  events=39,  estimated rate=0.6326611 , mean deviance=0.5485424 \n  left son=30 (11 obs) right son=31 (48 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.210171, (0 missing)\n      V10 < -1.343296   to the left,  improve=5.769029, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.190028, (0 missing)\n      V4  < -0.2372387  to the right, improve=2.868578, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.865246, (0 missing)",
        "\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.864, adj=0.273, (0 split)\n\nNode number 30: 11 observations\n  events=2,  estimated rate=0.1970443 , mean deviance=0.6211165 \n\nNode number 31: 48 observations,    complexity param=0.04370757\n  events=37,  estimated rate=0.7276209 , mean deviance=0.4037868 \n  left son=62 (25 obs) right son=63 (23 obs)\n  Primary splits:\n      V6  < -0.2319769  to the left,  improve=1.980303, (0 missing)\n      V17 < 1.389917    to the right, improve=1.747938, (0 missing)",
        "\n      V4  < -0.2372387  to the right, improve=1.446777, (0 missing)\n      V11 < -0.5454813  to the right, improve=1.446777, (0 missing)\n      V18 < 1.057646    to the right, improve=1.331061, (0 missing)\n  Surrogate splits:\n      V3  < -0.417756   to the left,  agree=0.833, adj=0.652, (0 split)\n      V8  < 0.9685894   to the right, agree=0.812, adj=0.609, (0 split)\n      V10 < -0.1721465  to the left,  agree=0.812, adj=0.609, (0 split)\n      V12 < -0.9078554  to the left,  agree=0.792, adj=0.565, (0 split)",
        "\n      V2  < -0.5448582  to the left,  agree=0.771, adj=0.522, (0 split)\n\nNode number 62: 25 observations,    complexity param=0.04370757\n  events=15,  estimated rate=0.5474765 , mean deviance=0.6178759 \n  left son=124 (7 obs) right son=125 (18 obs)\n  Primary splits:\n      V8  < 0.9685894   to the left,  improve=9.855122, (0 missing)\n      V12 < -0.8767279  to the right, improve=9.855122, (0 missing)\n      V7  < -0.9727557  to the right, improve=7.191441, (0 missing)\n      V4  < -0.7003098  to the right, improve=4.396144, (0 missing)",
        "\n      V3  < -1.242026   to the right, improve=2.902524, (0 missing)\n  Surrogate splits:\n      V12 < -0.8767279  to the right, agree=1.00, adj=1.000, (0 split)\n      V7  < -0.942676   to the right, agree=0.96, adj=0.857, (0 split)\n      V4  < -0.4911809  to the right, agree=0.92, adj=0.714, (0 split)\n      V9  < -0.8034842  to the right, agree=0.92, adj=0.714, (0 split)\n      V3  < -0.7347829  to the right, agree=0.88, adj=0.571, (0 split)\n\nNode number 63: 23 observations\n  events=22,  estimated rate=0.8448118 , mean deviance=0.09919846",
        " \n\nNode number 124: 7 observations\n  events=0,  estimated rate=0.08908686 , mean deviance=0.1781737 \n\nNode number 125: 18 observations\n  events=15,  estimated rate=0.71991 , mean deviance=0.3208685 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n    0.0120156203063983 0.0396432111000991 0.089086859688196 0.140597539543058 0.197044334975369 0.719910011248594\n  0                 79                 21                 7                 9                 9                 3\n  1                  0                  0                 0                 1                 2                15\n   van_predict\n    0.844811753902663\n  0                 1\n  1                22\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.4674556\n\nRestarting R session...\n\n",
        "> ",
        "install.packages(\"caret\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/vyas0/Documents/R/win-library/3.5’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/caret_6.0-84.zip'\n",
        "Content type 'application/zip'",
        " length 6223157 bytes (5.9 MB)\n",
        "downloaded 5.9 MB\n\n",
        "package ‘caret’ successfully unpacked and MD5 sums checked\nWarning in install.packages :\n  cannot remove prior installation of package ‘caret’\n\nThe downloaded binary packages are in\n\tC:\\Users\\vyas0\\AppData\\Local\\Temp\\Rtmp6nnvhY\\downloaded_packages\n",
        "> ",
        "# Importing data",
        "> ",
        "dataset <- read.table(file = \"data.dat\", header = FALSE)",
        "> ",
        "",
        "> ",
        "selected_data <- dataset[c(1,2,18)]",
        "> ",
        "",
        "> ",
        "#Calculate covariance matrix",
        "> ",
        "c <- cov(selected_data)",
        "> ",
        "",
        "> ",
        "correlation <- cor(selected_data)",
        "> ",
        "",
        "> ",
        "# Scatter plot ",
        "> ",
        "plot(dataset$V2,dataset$V18, xlab = \"CIRCULARITY\", ylab = \"HOLLOWS RATIO\")",
        "> ",
        "",
        "> ",
        "# Histogram",
        "> ",
        "hist(dataset$V1, main = \"Histogram of COMPACTNESS\", xlab = \"COMPACTNESS\", ylab = \"Frequency\")",
        "> ",
        "hist(dataset$V2, main = \"Histogram of CIRCULARITY\", xlab = \"CIRCULARITY\", ylab = \"Frequency\")",
        "> ",
        "",
        "> ",
        "selected_data <- dataset[c(1,2,18,19)]",
        "> ",
        "",
        "> ",
        "opel_hist_data <- selected_data[selected_data$V19 == \"opel\",]",
        "> ",
        "hist(opel_hist_data$V1, main = \"Histogram of COMPACTNESS of Opel\", xlab = \"COMPACTNESS\", ylab = \"Frequency\")",
        "> ",
        "hist(opel_hist_data$V2, main = \"Histogram of CIRCULARITY of Opel\", xlab = \"CIRCULARITY\", ylab = \"Frequency\")",
        "> ",
        "",
        "> ",
        "saab_hist_data <- selected_data[selected_data$V19 == 'saab',]",
        "> ",
        "hist(saab_hist_data$V1, main = \"Histogram of COMPACTNESS of Saab\", xlab = \"COMPACTNESS\", ylab = \"Frequency\")",
        "> ",
        "hist(saab_hist_data$V2, , main = \"Histogram of CIRCULARITY of Saab\", xlab = \"CIRCULARITY\", ylab = \"Frequency\")",
        "> ",
        "",
        "> ",
        "bus_hist_data <- selected_data[selected_data$V19 == 'bus',]",
        "> ",
        "hist(bus_hist_data$V1, main = \"Histogram of COMPACTNESS of Bus\", xlab = \"COMPACTNESS\", ylab = \"Frequency\")",
        "> ",
        "hist(bus_hist_data$V2, main = \"Histogram of CIRCULARITY of Bus\", xlab = \"CIRCULARITY\", ylab = \"Frequency\")",
        "> ",
        "",
        "> ",
        "van_hist_data <- selected_data[selected_data$V19 == 'van',]",
        "> ",
        "hist(van_hist_data$V1, main = \"Histogram of COMPACTNESS of Van\", xlab = \"COMPACTNESS\", ylab = \"Frequency\")",
        "> ",
        "hist(van_hist_data$V2, main = \"Histogram of CIRCULARITY of Van\", xlab = \"CIRCULARITY\", ylab = \"Frequency\")",
        "> ",
        "",
        "> ",
        "#Boxplot",
        "> ",
        "boxplot(dataset$V1,main=\"Boxplot of COMPACTNESS\", ylab = \"COMPACTNESS\")",
        "> ",
        "boxplot(opel_hist_data$V1,main=\"Boxplot of COMPACTNESS of Opel\", ylab = \"COMPACTNESS\")",
        "> ",
        "boxplot(saab_hist_data$V1,main=\"Boxplot of COMPACTNESS of Saab\", ylab = \"COMPACTNESS\")",
        "> ",
        "boxplot(bus_hist_data$V1,main=\"Boxplot of COMPACTNESS of Bus\", ylab = \"COMPACTNESS\")",
        "> ",
        "boxplot(van_hist_data$V1,main=\"Boxplot of COMPACTNESS of Van\", ylab = \"COMPACTNESS\")",
        "> ",
        "",
        "> ",
        "# Supervised scatter",
        "> ",
        "plot(selected_data$V1, selected_data$V2, col=c(\"red\",\"blue\")[dataset$V19],pch=19)",
        "> ",
        "plot(selected_data$V1, selected_data$V18, col=c(\"red\",\"blue\")[dataset$V19],pch=19)",
        "> ",
        "plot(selected_data$V2, selected_data$V18, col=c(\"red\",\"blue\")[dataset$V19],pch=19)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "# 6a",
        "> ",
        "# zscore",
        "> ",
        "zscore <- dataset",
        "> ",
        "zscore$V1 <- (dataset$V1 - mean(dataset$V1)) / sd(dataset$V1)",
        "> ",
        "zscore$V2 <- (dataset$V2 - mean(dataset$V2)) / sd(dataset$V2)",
        "> ",
        "zscore$V3 <- (dataset$V3 - mean(dataset$V3)) / sd(dataset$V3)",
        "> ",
        "zscore$V4 <- (dataset$V4 - mean(dataset$V4)) / sd(dataset$V4)",
        "> ",
        "zscore$V5 <- (dataset$V5 - mean(dataset$V5)) / sd(dataset$V5)",
        "> ",
        "zscore$V6 <- (dataset$V6 - mean(dataset$V6)) / sd(dataset$V6)",
        "> ",
        "zscore$V7 <- (dataset$V7 - mean(dataset$V7)) / sd(dataset$V7)",
        "> ",
        "zscore$V8 <- (dataset$V8 - mean(dataset$V8)) / sd(dataset$V8)",
        "> ",
        "zscore$V9 <- (dataset$V9 - mean(dataset$V9)) / sd(dataset$V9)",
        "> ",
        "",
        "> ",
        "zscore$V10 <- (dataset$V10 - mean(dataset$V10)) / sd(dataset$V10)",
        "> ",
        "zscore$V11 <- (dataset$V11 - mean(dataset$V11)) / sd(dataset$V11)",
        "> ",
        "zscore$V12 <- (dataset$V12 - mean(dataset$V12)) / sd(dataset$V12)",
        "> ",
        "zscore$V13 <- (dataset$V13 - mean(dataset$V13)) / sd(dataset$V13)",
        "> ",
        "zscore$V14 <- (dataset$V14 - mean(dataset$V14)) / sd(dataset$V14)",
        "> ",
        "zscore$V15 <- (dataset$V15 - mean(dataset$V15)) / sd(dataset$V15)",
        "> ",
        "zscore$V16 <- (dataset$V16 - mean(dataset$V16)) / sd(dataset$V16)",
        "> ",
        "zscore$V17 <- (dataset$V17 - mean(dataset$V17)) / sd(dataset$V17)",
        "> ",
        "zscore$V18 <- (dataset$V18 - mean(dataset$V18)) / sd(dataset$V18)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "# 6b",
        "> ",
        "zscore$B[zscore$V19== 'bus'] <- 1",
        "> ",
        "zscore$B[zscore$V19== 'opel'] <- 0",
        "> ",
        "zscore$B[zscore$V19== 'saab'] <- 0",
        "> ",
        "zscore$B[zscore$V19== 'van'] <- 0",
        "> ",
        "",
        "> ",
        "# 6c",
        "> ",
        "zscore$V[zscore$V19== 'bus'] <- 0",
        "> ",
        "zscore$V[zscore$V19== 'opel'] <- 0",
        "> ",
        "zscore$V[zscore$V19== 'saab'] <- 0",
        "> ",
        "zscore$V[zscore$V19== 'van'] <- 1",
        "> ",
        "",
        "> ",
        "library(rpart)",
        "> ",
        "library(dplyr)",
        "\nAttaching package: ‘dplyr’\n\n",
        "The following objects are masked from ‘package:stats’:\n\n    filter, lag\n\n",
        "The following objects are masked from ‘package:base’:\n\n    intersect, setdiff, setequal, union\n\n",
        "Warning message:\n",
        "package ‘dplyr’ was built under R version 3.5.3 \n",
        "> ",
        "library(caTools)",
        "Warning message:\n",
        "package ‘caTools’ was built under R version 3.5.3 \n",
        "> ",
        "install.packages(\"caret\")",
        "WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:\n\nhttps://cran.rstudio.com/bin/windows/Rtools/\n",
        "Installing package into ‘C:/Users/vyas0/Documents/R/win-library/3.5’\n(as ‘lib’ is unspecified)\n",
        "trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/caret_6.0-84.zip'\n",
        "Content type 'application/zip'",
        " length 6223157 bytes (5.9 MB)\n",
        "downloaded 5.9 MB\n\n",
        "package ‘caret’ successfully unpacked and MD5 sums checked\n\nThe downloaded binary packages are in\n\tC:\\Users\\vyas0\\AppData\\Local\\Temp\\Rtmp6nnvhY\\downloaded_packages\n",
        "> ",
        "library(caret)",
        "Loading required package: lattice\n",
        "Loading required package: ggplot2\n",
        "RStudio Community is a great place to get help: https://community.rstudio.com/c/tidyverse.\n",
        "Warning message:\n",
        "package ‘caret’ was built under R version 3.5.3 \n",
        "> ",
        "bus_data <- select(zscore,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18, B)",
        "> ",
        "set.seed(123)",
        "> ",
        "sample <- sample.split(bus_data$B, SplitRatio=0.8)",
        "> ",
        "",
        "> ",
        "bus_train = subset(bus_data, sample == TRUE)",
        "> ",
        "bus_test = subset(bus_data, sample == FALSE)",
        "> ",
        "",
        "> ",
        "fit <-rpart(B~.,",
        "+ ",
        "            method=\"anova\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRegression tree:\nrpart(formula = B ~ ., data = bus_test, method = \"anova\")\n\nVariables actually used in tree construction:\n[1] V10 V12 V15 V18 V6 \n\nRoot node error: 32.612/170 = 0.19183\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.286683      0   1.00000 1.00440 0.084850\n2 0.082370      2   0.42663 0.50758 0.092752\n3 0.062368      3   0.34426 0.53386 0.100953\n4 0.031354      4   0.28190 0.51287 0.097531\n5 0.010000      5   0.25054 0.48858 0.088495\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"anova\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.28668262      0 1.0000000 1.0044003 0.08485012\n2 0.08236987      2 0.4266348 0.5075835 0.09275171\n3 0.06236768      3 0.3442649 0.5338613 0.10095261\n4 0.03135378      4 0.2818972 0.5128679 0.09753054\n5 0.01000000      5 0.2505434 0.4885811 0.08849503\n\nVariable importance\nV12  V3  V6 V11  V7  V8  V9 V10 V18  V1  V2 V13 V14  V4 V16 V15  V5 \n 14  10  10  10  10  10   8   7   7   4   2 ",
        "  2   1   1   1   1   1 \n\nNode number 1: 170 observations,    complexity param=0.2866826\n  mean=0.2588235, MSE=0.1918339 \n  left son=2 (95 obs) right son=3 (75 obs)\n  Primary splits:\n      V6  < -0.2319769 to the right, improve=0.2807245, (0 missing)\n      V14 < 0.806444   to the left,  improve=0.2088595, (0 missing)\n      V18 < -0.8243789 to the right, improve=0.1836505, (0 missing)\n      V3  < -0.4494587 to the right, improve=0.1435168, (0 missing)\n      V11 < 1.747889   to the left,  improve=0.1414141, (0 missing)",
        "\n  Surrogate splits:\n      V3  < -0.5445668 to the right, agree=0.776, adj=0.493, (0 split)\n      V10 < 0.03452701 to the right, agree=0.753, adj=0.440, (0 split)\n      V18 < -0.6899486 to the right, agree=0.747, adj=0.427, (0 split)\n      V12 < -0.5060276 to the right, agree=0.735, adj=0.400, (0 split)\n      V1  < -0.6288789 to the right, agree=0.724, adj=0.373, (0 split)\n\nNode number 2: 95 observations,    complexity param=0.06236768\n  mean=0.05263158, MSE=0.0498615 \n  left son=4 (88 obs) right son=5 (7 obs)",
        "\n  Primary splits:\n      V18 < -0.6899486 to the right, improve=0.4293831, (0 missing)\n      V3  < -0.6079721 to the right, improve=0.3214286, (0 missing)\n      V14 < 0.405748   to the left,  improve=0.2847059, (0 missing)\n      V1  < -0.6288789 to the right, improve=0.2540284, (0 missing)\n      V17 < -0.8813544 to the right, improve=0.1916507, (0 missing)\n  Surrogate splits:\n      V4  < -1.148443  to the right, agree=0.968, adj=0.571, (0 split)\n      V5  < -1.165512  to the right, agree=0.958, adj=0.429, (0 split)",
        "\n      V14 < 0.6728787  to the left,  agree=0.958, adj=0.429, (0 split)\n      V1  < -1.296803  to the right, agree=0.947, adj=0.286, (0 split)\n      V3  < -1.083512  to the right, agree=0.947, adj=0.286, (0 split)\n\nNode number 3: 75 observations,    complexity param=0.2866826\n  mean=0.52, MSE=0.2496 \n  left son=6 (24 obs) right son=7 (51 obs)\n  Primary splits:\n      V12 < -0.8031538 to the left,  improve=0.5098039, (0 missing)\n      V8  < 0.840574   to the right, improve=0.4791667, (0 missing)\n      V11 < -0.8162264 to the left,  improve=0.4791667, (0 missing)",
        "\n      V2  < -0.5448582 to the left,  improve=0.4617028, (0 missing)\n      V7  < -0.7922774 to the left,  improve=0.4615385, (0 missing)\n  Surrogate splits:\n      V7  < -0.7922774 to the left,  agree=0.987, adj=0.958, (0 split)\n      V8  < 0.7125586  to the right, agree=0.987, adj=0.958, (0 split)\n      V11 < -0.8162264 to the left,  agree=0.987, adj=0.958, (0 split)\n      V9  < -0.8034842 to the left,  agree=0.933, adj=0.792, (0 split)\n      V3  < -1.337134  to the left,  agree=0.840, adj=0.500, (0 split)\n",
        "\nNode number 4: 88 observations\n  mean=0.01136364, MSE=0.0112345 \n\nNode number 5: 7 observations\n  mean=0.5714286, MSE=0.244898 \n\nNode number 6: 24 observations\n  mean=0, MSE=0 \n\nNode number 7: 51 observations,    complexity param=0.08236987\n  mean=0.7647059, MSE=0.1799308 \n  left son=14 (10 obs) right son=15 (41 obs)\n  Primary splits:\n      V10 < -0.9299492 to the left,  improve=0.2927298, (0 missing)\n      V2  < -0.7069363 to the left,  improve=0.2071417, (0 missing)\n      V15 < 0.4316346  to the right, improve=0.1803002, (0 missing)",
        "\n      V3  < -0.4494587 to the right, improve=0.1453297, (0 missing)\n      V14 < -0.1285132 to the left,  improve=0.1453297, (0 missing)\n  Surrogate splits:\n      V2  < -1.031092  to the left,  agree=0.961, adj=0.8, (0 split)\n      V13 < -1.066269  to the left,  agree=0.922, adj=0.6, (0 split)\n      V16 < 0.6606819  to the right, agree=0.882, adj=0.4, (0 split)\n      V18 < 0.7887851  to the right, agree=0.863, adj=0.3, (0 split)\n      V14 < -1.06347   to the left,  agree=0.843, adj=0.2, (0 split)\n\nNode number ",
        "14: 10 observations\n  mean=0.3, MSE=0.21 \n\nNode number 15: 41 observations,    complexity param=0.03135378\n  mean=0.8780488, MSE=0.1070791 \n  left son=30 (10 obs) right son=31 (31 obs)\n  Primary splits:\n      V15 < 0.2283145  to the right, improve=0.2329032, (0 missing)\n      V3  < -0.4494587 to the right, improve=0.1960784, (0 missing)\n      V7  < -0.4614003 to the right, improve=0.1608187, (0 missing)\n      V11 < -0.2906623 to the right, improve=0.1608187, (0 missing)\n      V12 < -0.5116872 to the right, improve=0.1608187, (0 missing)",
        "\n  Surrogate splits:\n      V1  < 1.678494   to the right, agree=0.805, adj=0.2, (0 split)\n      V10 < 1.136785   to the right, agree=0.780, adj=0.1, (0 split)\n\nNode number 30: 10 observations\n  mean=0.6, MSE=0.24 \n\nNode number 31: 31 observations\n  mean=0.9677419, MSE=0.03121748 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"classification tree for Bus\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n     0 0.0113636363636364 0.3 0.571428571428571 0.6 0.967741935483871\n  0 24                 87   7                 3   4                 1\n  1  0                  1   3                 4   6                30\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(B~.,",
        "+ ",
        "            method=\"class\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = B ~ ., data = bus_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V10 V12 V18 V6 \n\nRoot node error: 44/170 = 0.25882\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.306818      0   1.00000 1.00000 0.129788\n2 0.090909      2   0.38636 0.50000 0.099464\n3 0.022727      3   0.29545 0.45455 0.095474\n4 0.010000      4   0.27273 0.47727 0.097505\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"class\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.30681818      0 1.0000000 1.0000000 0.12978798\n2 0.09090909      2 0.3863636 0.5000000 0.09946380\n3 0.02272727      3 0.2954545 0.4545455 0.09547364\n4 0.01000000      4 0.2727273 0.4772727 0.09750472\n\nVariable importance\nV12  V3  V6 V11  V7  V8  V9 V18 V10  V1  V2 V13 V14  V4 V16  V5 \n 14  11  10  10  10  10   8   7   7   4   2   2   2   1   1   1 \n\nNode number 1: 170 observations",
        ",    complexity param=0.3068182\n  predicted class=0  expected loss=0.2588235  P(node) =1\n    class counts:   126    44\n   probabilities: 0.741 0.259 \n  left son=2 (95 obs) right son=3 (75 obs)\n  Primary splits:\n      V6  < -0.2319769 to the right, improve=18.309850, (0 missing)\n      V14 < 0.806444   to the left,  improve=13.622560, (0 missing)\n      V18 < -0.8243789 to the right, improve=11.978340, (0 missing)\n      V3  < -0.4494587 to the right, improve= 9.360672, (0 missing)\n      V8  < -1.463703  to the right, improve= 9.223529, (0 missing)",
        "\n  Surrogate splits:\n      V3  < -0.5445668 to the right, agree=0.776, adj=0.493, (0 split)\n      V10 < 0.03452701 to the right, agree=0.753, adj=0.440, (0 split)\n      V18 < -0.6899486 to the right, agree=0.747, adj=0.427, (0 split)\n      V12 < -0.5060276 to the right, agree=0.735, adj=0.400, (0 split)\n      V1  < -0.6288789 to the right, agree=0.724, adj=0.373, (0 split)\n\nNode number 2: 95 observations,    complexity param=0.02272727\n  predicted class=0  expected loss=0.05263158  P(node) =0.5588235\n    class counts:    90     5\n   probabilities: 0.947 0.053",
        " \n  left son=4 (88 obs) right son=5 (7 obs)\n  Primary splits:\n      V18 < -0.6899486 to the right, improve=4.067840, (0 missing)\n      V3  < -0.6079721 to the right, improve=3.045113, (0 missing)\n      V14 < 0.405748   to the left,  improve=2.697214, (0 missing)\n      V1  < -0.6288789 to the right, improve=2.406585, (0 missing)\n      V17 < -0.8813544 to the right, improve=1.815638, (0 missing)\n  Surrogate splits:\n      V4  < -1.148443  to the right, agree=0.968, adj=0.571, (0 split)\n      V5  < -1.165512  to the right, agree=0.958, adj=0.429, (0 split)",
        "\n      V14 < 0.6728787  to the left,  agree=0.958, adj=0.429, (0 split)\n      V1  < -1.296803  to the right, agree=0.947, adj=0.286, (0 split)\n      V3  < -1.083512  to the right, agree=0.947, adj=0.286, (0 split)\n\nNode number 3: 75 observations,    complexity param=0.3068182\n  predicted class=1  expected loss=0.48  P(node) =0.4411765\n    class counts:    36    39\n   probabilities: 0.480 0.520 \n  left son=6 (24 obs) right son=7 (51 obs)\n  Primary splits:\n      V12 < -0.8031538 to the left,  improve=19.08706, (0 missing)",
        "\n      V8  < 0.840574   to the right, improve=17.94000, (0 missing)\n      V11 < -0.8162264 to the left,  improve=17.94000, (0 missing)\n      V2  < -0.5448582 to the left,  improve=17.28615, (0 missing)\n      V7  < -0.7922774 to the left,  improve=17.28000, (0 missing)\n  Surrogate splits:\n      V7  < -0.7922774 to the left,  agree=0.987, adj=0.958, (0 split)\n      V8  < 0.7125586  to the right, agree=0.987, adj=0.958, (0 split)\n      V11 < -0.8162264 to the left,  agree=0.987, adj=0.958, (0 split)\n      V9  < -0.8034842 to the left,  agree=0.933, adj=0.792, (0 split)",
        "\n      V3  < -1.337134  to the left,  agree=0.840, adj=0.500, (0 split)\n\nNode number 4: 88 observations\n  predicted class=0  expected loss=0.01136364  P(node) =0.5176471\n    class counts:    87     1\n   probabilities: 0.989 0.011 \n\nNode number 5: 7 observations\n  predicted class=1  expected loss=0.4285714  P(node) =0.04117647\n    class counts:     3     4\n   probabilities: 0.429 0.571 \n\nNode number 6: 24 observations\n  predicted class=0  expected loss=0  P(node) =0.1411765\n    class counts:    24     0\n   probabilities: 1.000 0.000",
        " \n\nNode number 7: 51 observations,    complexity param=0.09090909\n  predicted class=1  expected loss=0.2352941  P(node) =0.3\n    class counts:    12    39\n   probabilities: 0.235 0.765 \n  left son=14 (10 obs) right son=15 (41 obs)\n  Primary splits:\n      V10 < -0.9299492 to the left,  improve=5.372453, (0 missing)\n      V2  < -0.7069363 to the left,  improve=3.801659, (0 missing)\n      V15 < 0.4316346  to the right, improve=3.309039, (0 missing)\n      V3  < -0.4494587 to the right, improve=2.667227, (0 missing)",
        "\n      V14 < -0.1285132 to the left,  improve=2.667227, (0 missing)\n  Surrogate splits:\n      V2  < -1.031092  to the left,  agree=0.961, adj=0.8, (0 split)\n      V13 < -1.066269  to the left,  agree=0.922, adj=0.6, (0 split)\n      V16 < 0.6606819  to the right, agree=0.882, adj=0.4, (0 split)\n      V18 < 0.7887851  to the right, agree=0.863, adj=0.3, (0 split)\n      V14 < -1.06347   to the left,  agree=0.843, adj=0.2, (0 split)\n\nNode number 14: 10 observations\n  predicted class=0  expected loss=0.3  P(node) =0.05882353\n    class counts:     7     3\n   probabilities: 0.700 0.300",
        " \n\nNode number 15: 41 observations\n  predicted class=1  expected loss=0.1219512  P(node) =0.2411765\n    class counts:     5    36\n   probabilities: 0.122 0.878 \n\n",
        "> ",
        "",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification Tree for B\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test, type=\"class\")",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n      0   1\n  0 118   8\n  1   4  40\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(B~.,",
        "+ ",
        "            method=\"poisson\", data=bus_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRates regression tree:\nrpart(formula = B ~ ., data = bus_test, method = \"poisson\")\n\nVariables actually used in tree construction:\n[1] V12 V14 V3  V6 \n\nRoot node error: 118.94/170 = 0.69966\n\nn= 170 \n\n        CP nsplit rel error  xerror     xstd\n1 0.328054      0   1.00000 1.00832 0.034652\n2 0.281472      1   0.67195 0.75590 0.083797\n3 0.094285      2   0.39047 0.56229 0.106622\n4 0.027056      4   0.20190 0.63030 0.128222\n5 0.010000      5   0.17485 0.62704 0.128200\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = B ~ ., data = bus_test, method = \"poisson\")\n  n= 170 \n\n          CP nsplit rel error    xerror       xstd\n1 0.32805351      0 1.0000000 1.0083189 0.03465219\n2 0.28147178      1 0.6719465 0.7559014 0.08379659\n3 0.09428514      2 0.3904747 0.5622933 0.10662248\n4 0.02705634      4 0.2019044 0.6302994 0.12822165\n5 0.01000000      5 0.1748481 0.6270394 0.12819950\n\nVariable importance\n V7  V3  V9 V12  V6 V11  V8 V10  V2  V5 V14 V18 V17  V4  V1 \n 15  13  13  11  10  10   8   6   5   4   2   1 ",
        "  1   1   1 \n\nNode number 1: 170 observations,    complexity param=0.3280535\n  events=44,  estimated rate=0.2588235 , mean deviance=0.6996563 \n  left son=2 (72 obs) right son=3 (98 obs)\n  Primary splits:\n      V6  < -0.01464306 to the right, improve=39.54425, (0 missing)\n      V11 < -0.8003002  to the left,  improve=21.59954, (0 missing)\n      V12 < -0.800324   to the left,  improve=20.94036, (0 missing)\n      V14 < 0.806444    to the left,  improve=20.62782, (0 missing)\n      V18 < -0.8243789  to the right, improve=19.63493, (0 missing)",
        "\n  Surrogate splits:\n      V10 < 0.03452701  to the right, agree=0.841, adj=0.625, (0 split)\n      V3  < -0.03732373 to the right, agree=0.835, adj=0.611, (0 split)\n      V2  < 0.2655322   to the right, agree=0.782, adj=0.486, (0 split)\n      V7  < 0.03491524  to the right, agree=0.771, adj=0.458, (0 split)\n      V9  < -0.4177024  to the right, agree=0.771, adj=0.458, (0 split)\n\nNode number 2: 72 observations,    complexity param=0.02705634\n  events=1,  estimated rate=0.02636309 , mean deviance=0.1259426 \n  left son=",
        "4 (65 obs) right son=5 (7 obs)\n  Primary splits:\n      V6  < 0.6373584   to the left,  improve=4.661512, (0 missing)\n      V10 < -0.2754832  to the right, improve=4.661512, (0 missing)\n      V3  < -0.3543506  to the right, improve=4.394449, (0 missing)\n      V18 < -0.2866576  to the right, improve=4.394449, (0 missing)\n      V1  < -0.5074382  to the right, improve=4.158883, (0 missing)\n  Surrogate splits:\n      V4 < 1.749486    to the left,  agree=0.931, adj=0.286, (0 split)\n      V5 < 0.9895915   to the left,  agree=0.931, adj=0.286, (0 split)",
        "\n\nNode number 3: 98 observations,    complexity param=0.2814718\n  events=43,  estimated rate=0.43195 , mean deviance=0.7230052 \n  left son=6 (33 obs) right son=7 (65 obs)\n  Primary splits:\n      V12 < -0.800324   to the left,  improve=35.30990, (0 missing)\n      V7  < -0.8524368  to the left,  improve=31.42954, (0 missing)\n      V8  < 0.840574    to the right, improve=31.42954, (0 missing)\n      V11 < -0.8003002  to the left,  improve=31.42954, (0 missing)\n      V2  < -0.5448582  to the left,  improve=21.21730, (0 missing)",
        "\n  Surrogate splits:\n      V7  < -0.7922774  to the left,  agree=0.990, adj=0.970, (0 split)\n      V8  < 0.7125586   to the right, agree=0.990, adj=0.970, (0 split)\n      V11 < -0.8003002  to the left,  agree=0.969, adj=0.909, (0 split)\n      V9  < -0.8034842  to the left,  agree=0.929, adj=0.788, (0 split)\n      V3  < -0.9567017  to the left,  agree=0.796, adj=0.394, (0 split)\n\nNode number 4: 65 observations\n  events=0,  estimated rate=0.01452145 , mean deviance=0.0290429 \n\nNode number 5: 7 observations\n  events=1,  estimated rate=0.1841004 , mean deviance=0.5659934",
        " \n\nNode number 6: 33 observations\n  events=0,  estimated rate=0.027127 , mean deviance=0.05425401 \n\nNode number 7: 65 observations,    complexity param=0.09428514\n  events=43,  estimated rate=0.6389439 , mean deviance=0.5474681 \n  left son=14 (32 obs) right son=15 (33 obs)\n  Primary splits:\n      V14 < -0.1285132  to the left,  improve=6.395034, (0 missing)\n      V10 < -0.8955036  to the left,  improve=5.746932, (0 missing)\n      V3  < -0.5445668  to the right, improve=5.429323, (0 missing)\n      V2  < -1.031092   to the left,  improve=4.703332, (0 missing)",
        "\n      V6  < -0.2319769  to the right, improve=4.587401, (0 missing)\n  Surrogate splits:\n      V18 < -0.7571637  to the right, agree=0.908, adj=0.812, (0 split)\n      V17 < -0.5568871  to the right, agree=0.892, adj=0.781, (0 split)\n      V4  < -0.4911809  to the right, agree=0.754, adj=0.500, (0 split)\n      V1  < -0.7503195  to the right, agree=0.723, adj=0.438, (0 split)\n      V5  < -0.4682728  to the right, agree=0.708, adj=0.406, (0 split)\n\nNode number 14: 32 observations,    complexity param=0.09428514",
        "\n  events=13,  estimated rate=0.3903676 , mean deviance=0.7325267 \n  left son=28 (16 obs) right son=29 (16 obs)\n  Primary splits:\n      V3  < -0.4494587  to the right, improve=18.021830, (0 missing)\n      V5  < 0.5458937   to the left,  improve=10.740090, (0 missing)\n      V6  < -0.4493107  to the right, improve= 6.542553, (0 missing)\n      V11 < -0.1314004  to the right, improve= 5.193881, (0 missing)\n      V7  < -0.386201   to the right, improve= 4.903542, (0 missing)\n  Surrogate splits:\n      V5  < 0.5458937   to the left,  agree=0.844, adj=0.688, (0 split)",
        "\n      V7  < -0.4614003  to the right, agree=0.781, adj=0.562, (0 split)\n      V9  < -0.4177024  to the right, agree=0.781, adj=0.562, (0 split)\n      V11 < -0.3065885  to the right, agree=0.781, adj=0.562, (0 split)\n      V12 < -0.3617092  to the right, agree=0.781, adj=0.562, (0 split)\n\nNode number 15: 33 observations\n  events=30,  estimated rate=0.8409371 , mean deviance=0.1786713 \n\nNode number 28: 16 observations\n  events=0,  estimated rate=0.05034325 , mean deviance=0.1006865 \n\nNode number 29: 16 observations",
        "\n  events=13,  estimated rate=0.7048055 , mean deviance=0.3530903 \n\n",
        "> ",
        "",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification Tree for B\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "fit.B.predicted <- predict(fit, bus_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(bus_test$B, fit.B.predicted)",
        "> ",
        "table_mat",
        "   fit.B.predicted\n    0.0145214521452145 0.0271270036991369 0.0503432494279176 0.184100418410042 0.704805491990847 0.840937114673243\n  0                 65                 33                 16                 6                 3                 3\n  1                  0                  0                  0                 1                13                30\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "van_data <- select(zscore,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18, V)",
        "> ",
        "set.seed(123)",
        "> ",
        "sample <- sample.split(van_data$V, SplitRatio=0.8)",
        "> ",
        "",
        "> ",
        "van_train = subset(van_data, sample == TRUE)",
        "> ",
        "van_test = subset(van_data, sample == FALSE)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"anova\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRegression tree:\nrpart(formula = V ~ ., data = van_test, method = \"anova\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V4  V6  V7 \n\nRoot node error: 30.533/169 = 0.18067\n\nn= 169 \n\n        CP nsplit rel error  xerror     xstd\n1 0.333434      0   1.00000 1.00569 0.095836\n2 0.174691      1   0.66657 0.74523 0.083890\n3 0.108528      2   0.49187 0.68511 0.100030\n4 0.035217      3   0.38335 0.50197 0.096360\n5 0.013399      5   0.31291 0.48978 0.101074\n6 0.010000      6   0.29951 0.49393 0.100990",
        "\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"anova\")\n  n= 169 \n\n          CP nsplit rel error    xerror       xstd\n1 0.33343426      0 1.0000000 1.0056922 0.09583636\n2 0.17469118      1 0.6665657 0.7452283 0.08389049\n3 0.10852801      2 0.4918746 0.6851064 0.10003007\n4 0.03521724      3 0.3833465 0.5019685 0.09636000\n5 0.01339852      5 0.3129121 0.4897834 0.10107408\n6 0.01000000      6 0.2995135 0.4939281 0.10099013\n\nVariable importance\nV11 V12  V8  V7  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 ",
        "\n 15  12  12  12  11   8   7   5   4   4   4   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.3334343\n  mean=0.2366864, MSE=0.1806659 \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=0.3334343, (0 missing)\n      V8  < 0.2004969   to the left,  improve=0.2721792, (0 missing)\n      V12 < -0.3843474  to the right, improve=0.2301606, (0 missing)\n      V4  < -0.222301   to the right, improve=0.2271689, (0 missing)\n      V7  < -0.7321179  to the right, improve=0.2155511, (0 missing)",
        "\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations,    complexity param=0.01339852\n  mean=0.03030303, MSE=0.02938476 \n  left son=4 (81 obs) right son=",
        "5 (18 obs)\n  Primary splits:\n      V4  < -0.2521765  to the right, improve=0.14062500, (0 missing)\n      V8  < 0.2004969   to the left,  improve=0.12343750, (0 missing)\n      V17 < -0.5568871  to the right, improve=0.09765625, (0 missing)\n      V11 < -0.2588099  to the right, improve=0.09250000, (0 missing)\n      V12 < -0.3843474  to the right, improve=0.08333333, (0 missing)\n  Surrogate splits:\n      V1  < -0.7503195  to the right, agree=0.939, adj=0.667, (0 split)\n      V8  < 0.3285124   to the left,  agree=0.929, adj=0.611, (0 split)",
        "\n      V3  < -0.6079721  to the right, agree=0.919, adj=0.556, (0 split)\n      V12 < -0.4437726  to the right, agree=0.919, adj=0.556, (0 split)\n      V11 < -0.4499242  to the right, agree=0.899, adj=0.444, (0 split)\n\nNode number 3: 70 observations,    complexity param=0.1746912\n  mean=0.5285714, MSE=0.2491837 \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=0.3057851, (0 missing)\n      V6  < -0.01464306 to the left,  improve=0.2432432, (0 missing)\n",
        "      V14 < 0.9400093   to the right, improve=0.2335145, (0 missing)\n      V1  < -1.236082   to the left,  improve=0.1867023, (0 missing)\n      V18 < -1.496531   to the left,  improve=0.1867023, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)",
        "\n\nNode number 4: 81 observations\n  mean=0, MSE=0 \n\nNode number 5: 18 observations\n  mean=0.1666667, MSE=0.1388889 \n\nNode number 6: 15 observations\n  mean=0, MSE=0 \n\nNode number 7: 55 observations,    complexity param=0.108528\n  mean=0.6727273, MSE=0.2201653 \n  left son=14 (11 obs) right son=15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=0.2736486, (0 missing)\n      V10 < -0.3099288  to the left,  improve=0.2193980, (0 missing)\n      V6  < -0.01464306 to the left,  improve=0.1824324, (0 missing)",
        "\n      V2  < -1.355249   to the left,  improve=0.1084835, (0 missing)\n      V7  < -0.4614003  to the left,  improve=0.1081081, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)\n\nNode number 14: 11 observations\n  mean=0.1818182, MSE=0.1487603 \n\nNode number 15: 44 observations,    complexity param=0.03521724\n  mean=0.7954545, MSE=0.1627066 \n  left son=30 (31 obs) right son=31 (13 obs)\n",
        "  Primary splits:\n      V6  < -0.01464306 to the left,  improve=0.10783410, (0 missing)\n      V10 < -0.3099288  to the left,  improve=0.10779620, (0 missing)\n      V4  < -0.9841276  to the right, improve=0.08217312, (0 missing)\n      V7  < -0.5967591  to the left,  improve=0.07563025, (0 missing)\n      V12 < -0.6192186  to the left,  improve=0.07563025, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)",
        "\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.03521724\n  mean=0.7096774, MSE=0.2060354 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=0.2158335, (0 missing)\n      V12 < -0.9220043  to the right, improve=0.2158335, (0 missing)",
        "\n      V8  < 0.9685894   to the left,  improve=0.1737603, (0 missing)\n      V13 < -0.7590161  to the right, improve=0.1414983, (0 missing)\n      V4  < -0.8496876  to the right, improve=0.1347687, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)",
        "\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)\n\nNode number 31: 13 observations\n  mean=1, MSE=0 \n\nNode number 60: 13 observations\n  mean=0.4615385, MSE=0.2485207 \n\nNode number 61: 18 observations\n  mean=0.8888889, MSE=0.09876543 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n     0 0.166666666666667 0.181818181818182 0.461538461538462 0.888888888888889  1\n  0 96                15                 9                 7                 2  0\n  1  0                 3                 2                 6                16 13\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.5857988\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"class\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V6  V7 \n\nRoot node error: 40/169 = 0.23669\n\nn= 169 \n\n      CP nsplit rel error xerror    xstd\n1 0.2375      0     1.000  1.000 0.13814\n2 0.1750      2     0.525  0.750 0.12418\n3 0.0125      3     0.350  0.475 0.10266\n4 0.0100      5     0.325  0.525 0.10721\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n  n= 169 \n\n      CP nsplit rel error xerror      xstd\n1 0.2375      0     1.000  1.000 0.1381407\n2 0.1750      2     0.525  0.750 0.1241837\n3 0.0125      3     0.350  0.475 0.1026642\n4 0.0100      5     0.325  0.525 0.1072105\n\nVariable importance\nV11 V12  V7  V8  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 \n 15  12  12  12  11   8   7   5   4   4   3   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.2375\n  predicted class=0  expected loss=0.2366864  P(node) =1\n    class counts:   129    40\n   probabilities: 0.763 0.237",
        " \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=20.36119, (0 missing)\n      V8  < 0.2004969   to the left,  improve=16.62064, (0 missing)\n      V12 < -0.3843474  to the right, improve=14.05478, (0 missing)\n      V4  < -0.222301   to the right, improve=13.87209, (0 missing)\n      V7  < -0.7321179  to the right, improve=13.16265, (0 missing)\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)",
        "\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations\n  predicted class=0  expected loss=0.03030303  P(node) =0.5857988\n    class counts:    96     3\n   probabilities: 0.970 0.030 \n\nNode number 3: 70 observations,    complexity param=0.2375\n  predicted class=1  expected loss=0.4714286  P(node) =0.4142012\n    class counts:    33    37\n   probabilities: 0.471 0.529",
        " \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=10.667530, (0 missing)\n      V6  < -0.01464306 to the left,  improve= 8.485714, (0 missing)\n      V14 < 0.9400093   to the right, improve= 8.146320, (0 missing)\n      V1  < -1.236082   to the left,  improve= 6.513245, (0 missing)\n      V18 < -1.496531   to the left,  improve= 6.513245, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)",
        "\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)\n\nNode number 6: 15 observations\n  predicted class=0  expected loss=0  P(node) =0.0887574\n    class counts:    15     0\n   probabilities: 1.000 0.000 \n\nNode number 7: 55 observations,    complexity param=0.175\n  predicted class=1  expected loss=0.3272727  P(node) =0.3254438\n    class counts:    18    37\n   probabilities: 0.327 0.673 \n  left son=14 (11 obs) right son=",
        "15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.627273, (0 missing)\n      V10 < -0.3099288  to the left,  improve=5.313420, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.418182, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.627273, (0 missing)\n      V7  < -0.4614003  to the left,  improve=2.618182, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)",
        "\n\nNode number 14: 11 observations\n  predicted class=0  expected loss=0.1818182  P(node) =0.06508876\n    class counts:     9     2\n   probabilities: 0.818 0.182 \n\nNode number 15: 44 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2045455  P(node) =0.260355\n    class counts:     9    35\n   probabilities: 0.205 0.795 \n  left son=30 (31 obs) right son=31 (13 obs)\n  Primary splits:\n      V6  < -0.01464306 to the left,  improve=1.543988, (0 missing)\n      V10 < -0.3099288  to the left,  improve=1.543445, (0 missing)",
        "\n      V4  < -0.9841276  to the right, improve=1.176570, (0 missing)\n      V7  < -0.5967591  to the left,  improve=1.082888, (0 missing)\n      V12 < -0.6192186  to the left,  improve=1.082888, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)",
        "\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2903226  P(node) =0.183432\n    class counts:     9    22\n   probabilities: 0.290 0.710 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=2.757100, (0 missing)\n      V12 < -0.9220043  to the right, improve=2.757100, (0 missing)\n      V8  < 0.9685894   to the left,  improve=2.219648, (0 missing)",
        "\n      V13 < -0.7590161  to the right, improve=1.807527, (0 missing)\n      V4  < -0.8496876  to the right, improve=1.721562, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)",
        "\n\nNode number 31: 13 observations\n  predicted class=1  expected loss=0  P(node) =0.07692308\n    class counts:     0    13\n   probabilities: 0.000 1.000 \n\nNode number 60: 13 observations\n  predicted class=0  expected loss=0.4615385  P(node) =0.07692308\n    class counts:     7     6\n   probabilities: 0.538 0.462 \n\nNode number 61: 18 observations\n  predicted class=1  expected loss=0.1111111  P(node) =0.1065089\n    class counts:     2    16\n   probabilities: 0.111 0.889 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test, type = \"class\")",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n      0   1\n  0 127   2\n  1  11  29\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.9230769\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"poisson\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nRates regression tree:\nrpart(formula = V ~ ., data = van_test, method = \"poisson\")\n\nVariables actually used in tree construction:\n[1] V1  V14 V16 V6  V8 \n\nRoot node error: 115.28/169 = 0.68214\n\nn= 169 \n\n        CP nsplit rel error  xerror     xstd\n1 0.420630      0   1.00000 1.01266 0.043694\n2 0.169683      1   0.57937 0.67150 0.080948\n3 0.056958      2   0.40969 0.56276 0.091641\n4 0.053347      3   0.35273 0.54142 0.106402\n5 0.043708      4   0.29938 0.54109 0.106559\n6 0.010000      6   0.21197 0.49843 0.105466",
        "\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"poisson\")\n  n= 169 \n\n          CP nsplit rel error    xerror       xstd\n1 0.42062963      0 1.0000000 1.0126597 0.04369370\n2 0.16968326      1 0.5793704 0.6714964 0.08094807\n3 0.05695812      2 0.4096871 0.5627635 0.09164148\n4 0.05334726      3 0.3527290 0.5414230 0.10640154\n5 0.04370757      4 0.2993817 0.5410929 0.10655879\n6 0.01000000      6 0.2119666 0.4984291 0.10546575\n\nVariable importance\n V8 V12  V4  V7  V9 V11 V14 V18 V17  V1  V3 V16 V10 \n 15 ",
        " 15  14  13  12  12   5   4   4   3   2   2   1 \n\nNode number 1: 169 observations,    complexity param=0.4206296\n  events=40,  estimated rate=0.2366864 , mean deviance=0.6821393 \n  left son=2 (79 obs) right son=3 (90 obs)\n  Primary splits:\n      V8  < 0.2004969   to the left,  improve=50.40712, (0 missing)\n      V11 < -0.4499242  to the right, improve=48.38343, (0 missing)\n      V12 < -0.3843474  to the right, improve=44.41502, (0 missing)\n      V4  < 0.04657903  to the right, improve=42.78231, (0 missing)\n",
        "      V7  < -0.2508422  to the right, improve=41.18226, (0 missing)\n  Surrogate splits:\n      V12 < -0.4607513  to the right, agree=0.976, adj=0.949, (0 split)\n      V11 < -0.2588099  to the right, agree=0.970, adj=0.937, (0 split)\n      V7  < -0.2508422  to the right, agree=0.935, adj=0.861, (0 split)\n      V4  < -0.1774876  to the right, agree=0.923, adj=0.835, (0 split)\n      V9  < -0.4177024  to the right, agree=0.905, adj=0.797, (0 split)\n\nNode number 2: 79 observations\n  events=0,  estimated rate=0.01201562 , mean deviance=0.02403124",
        " \n\nNode number 3: 90 observations,    complexity param=0.1696833\n  events=40,  estimated rate=0.4351287 , mean deviance=0.7210249 \n  left son=6 (21 obs) right son=7 (69 obs)\n  Primary splits:\n      V14 < 1.073575    to the right, improve=21.25625, (0 missing)\n      V17 < -1.368055   to the left,  improve=21.25625, (0 missing)\n      V1  < -1.357523   to the left,  improve=13.52611, (0 missing)\n      V18 < -1.496531   to the left,  improve=13.25813, (0 missing)\n      V6  < -0.01464306 to the left,  improve=12.70698, (0 missing)",
        "\n  Surrogate splits:\n      V18 < -1.496531   to the left,  agree=0.944, adj=0.762, (0 split)\n      V17 < -1.205822   to the left,  agree=0.933, adj=0.714, (0 split)\n      V4  < -1.357572   to the left,  agree=0.833, adj=0.286, (0 split)\n      V1  < -1.478964   to the left,  agree=0.811, adj=0.190, (0 split)\n\nNode number 6: 21 observations\n  events=0,  estimated rate=0.03964321 , mean deviance=0.07928642 \n\nNode number 7: 69 observations,    complexity param=0.05695812\n  events=40,  estimated rate=0.5599181 , mean deviance=0.6328388",
        " \n  left son=14 (10 obs) right son=15 (59 obs)\n  Primary splits:\n      V1  < -1.236082   to the left,  improve=6.722882, (0 missing)\n      V16 < 0.5487154   to the right, improve=6.660775, (0 missing)\n      V6  < -0.01464306 to the left,  improve=6.623704, (0 missing)\n      V10 < -1.343296   to the left,  improve=5.622647, (0 missing)\n      V7  < -0.4614003  to the left,  improve=4.224364, (0 missing)\n\nNode number 14: 10 observations\n  events=1,  estimated rate=0.1405975 , mean deviance=0.4735658 \n\nNode number ",
        "15: 59 observations,    complexity param=0.05334726\n  events=39,  estimated rate=0.6326611 , mean deviance=0.5485424 \n  left son=30 (11 obs) right son=31 (48 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.210171, (0 missing)\n      V10 < -1.343296   to the left,  improve=5.769029, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.190028, (0 missing)\n      V4  < -0.2372387  to the right, improve=2.868578, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.865246, (0 missing)",
        "\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.864, adj=0.273, (0 split)\n\nNode number 30: 11 observations\n  events=2,  estimated rate=0.1970443 , mean deviance=0.6211165 \n\nNode number 31: 48 observations,    complexity param=0.04370757\n  events=37,  estimated rate=0.7276209 , mean deviance=0.4037868 \n  left son=62 (25 obs) right son=63 (23 obs)\n  Primary splits:\n      V6  < -0.2319769  to the left,  improve=1.980303, (0 missing)\n      V17 < 1.389917    to the right, improve=1.747938, (0 missing)",
        "\n      V4  < -0.2372387  to the right, improve=1.446777, (0 missing)\n      V11 < -0.5454813  to the right, improve=1.446777, (0 missing)\n      V18 < 1.057646    to the right, improve=1.331061, (0 missing)\n  Surrogate splits:\n      V3  < -0.417756   to the left,  agree=0.833, adj=0.652, (0 split)\n      V8  < 0.9685894   to the right, agree=0.812, adj=0.609, (0 split)\n      V10 < -0.1721465  to the left,  agree=0.812, adj=0.609, (0 split)\n      V12 < -0.9078554  to the left,  agree=0.792, adj=0.565, (0 split)",
        "\n      V2  < -0.5448582  to the left,  agree=0.771, adj=0.522, (0 split)\n\nNode number 62: 25 observations,    complexity param=0.04370757\n  events=15,  estimated rate=0.5474765 , mean deviance=0.6178759 \n  left son=124 (7 obs) right son=125 (18 obs)\n  Primary splits:\n      V8  < 0.9685894   to the left,  improve=9.855122, (0 missing)\n      V12 < -0.8767279  to the right, improve=9.855122, (0 missing)\n      V7  < -0.9727557  to the right, improve=7.191441, (0 missing)\n      V4  < -0.7003098  to the right, improve=4.396144, (0 missing)",
        "\n      V3  < -1.242026   to the right, improve=2.902524, (0 missing)\n  Surrogate splits:\n      V12 < -0.8767279  to the right, agree=1.00, adj=1.000, (0 split)\n      V7  < -0.942676   to the right, agree=0.96, adj=0.857, (0 split)\n      V4  < -0.4911809  to the right, agree=0.92, adj=0.714, (0 split)\n      V9  < -0.8034842  to the right, agree=0.92, adj=0.714, (0 split)\n      V3  < -0.7347829  to the right, agree=0.88, adj=0.571, (0 split)\n\nNode number 63: 23 observations\n  events=22,  estimated rate=0.8448118 , mean deviance=0.09919846",
        " \n\nNode number 124: 7 observations\n  events=0,  estimated rate=0.08908686 , mean deviance=0.1781737 \n\nNode number 125: 18 observations\n  events=15,  estimated rate=0.71991 , mean deviance=0.3208685 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test)",
        "> ",
        "",
        "> ",
        "table_mat <- table(van_test$V, van_predict)",
        "> ",
        "table_mat",
        "   van_predict\n    0.0120156203063983 0.0396432111000991 0.089086859688196 0.140597539543058 0.197044334975369 0.719910011248594\n  0                 79                 21                 7                 9                 9                 3\n  1                  0                  0                 0                 1                 2                15\n   van_predict\n    0.844811753902663\n  0                 1\n  1                22\n",
        "> ",
        "",
        "> ",
        "accuracy_Test <- sum(diag(table_mat)) / sum(table_mat)",
        "> ",
        "accuracy_Test",
        "[1] 0.4674556\n",
        "> ",
        "fit <-rpart(V~.,",
        "+ ",
        "            method=\"class\", data=van_test)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V6  V7 \n\nRoot node error: 40/169 = 0.23669\n\nn= 169 \n\n      CP nsplit rel error xerror    xstd\n1 0.2375      0     1.000  1.000 0.13814\n2 0.1750      2     0.525  0.650 0.11726\n3 0.0125      3     0.350  0.475 0.10266\n4 0.0100      5     0.325  0.525 0.10721\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n  n= 169 \n\n      CP nsplit rel error xerror      xstd\n1 0.2375      0     1.000  1.000 0.1381407\n2 0.1750      2     0.525  0.650 0.1172604\n3 0.0125      3     0.350  0.475 0.1026642\n4 0.0100      5     0.325  0.525 0.1072105\n\nVariable importance\nV11 V12  V7  V8  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 \n 15  12  12  12  11   8   7   5   4   4   3   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.2375\n  predicted class=0  expected loss=0.2366864  P(node) =1\n    class counts:   129    40\n   probabilities: 0.763 0.237",
        " \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=20.36119, (0 missing)\n      V8  < 0.2004969   to the left,  improve=16.62064, (0 missing)\n      V12 < -0.3843474  to the right, improve=14.05478, (0 missing)\n      V4  < -0.222301   to the right, improve=13.87209, (0 missing)\n      V7  < -0.7321179  to the right, improve=13.16265, (0 missing)\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)",
        "\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations\n  predicted class=0  expected loss=0.03030303  P(node) =0.5857988\n    class counts:    96     3\n   probabilities: 0.970 0.030 \n\nNode number 3: 70 observations,    complexity param=0.2375\n  predicted class=1  expected loss=0.4714286  P(node) =0.4142012\n    class counts:    33    37\n   probabilities: 0.471 0.529",
        " \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=10.667530, (0 missing)\n      V6  < -0.01464306 to the left,  improve= 8.485714, (0 missing)\n      V14 < 0.9400093   to the right, improve= 8.146320, (0 missing)\n      V1  < -1.236082   to the left,  improve= 6.513245, (0 missing)\n      V18 < -1.496531   to the left,  improve= 6.513245, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)",
        "\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)\n\nNode number 6: 15 observations\n  predicted class=0  expected loss=0  P(node) =0.0887574\n    class counts:    15     0\n   probabilities: 1.000 0.000 \n\nNode number 7: 55 observations,    complexity param=0.175\n  predicted class=1  expected loss=0.3272727  P(node) =0.3254438\n    class counts:    18    37\n   probabilities: 0.327 0.673 \n  left son=14 (11 obs) right son=",
        "15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.627273, (0 missing)\n      V10 < -0.3099288  to the left,  improve=5.313420, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.418182, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.627273, (0 missing)\n      V7  < -0.4614003  to the left,  improve=2.618182, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)",
        "\n\nNode number 14: 11 observations\n  predicted class=0  expected loss=0.1818182  P(node) =0.06508876\n    class counts:     9     2\n   probabilities: 0.818 0.182 \n\nNode number 15: 44 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2045455  P(node) =0.260355\n    class counts:     9    35\n   probabilities: 0.205 0.795 \n  left son=30 (31 obs) right son=31 (13 obs)\n  Primary splits:\n      V6  < -0.01464306 to the left,  improve=1.543988, (0 missing)\n      V10 < -0.3099288  to the left,  improve=1.543445, (0 missing)",
        "\n      V4  < -0.9841276  to the right, improve=1.176570, (0 missing)\n      V7  < -0.5967591  to the left,  improve=1.082888, (0 missing)\n      V12 < -0.6192186  to the left,  improve=1.082888, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)",
        "\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2903226  P(node) =0.183432\n    class counts:     9    22\n   probabilities: 0.290 0.710 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=2.757100, (0 missing)\n      V12 < -0.9220043  to the right, improve=2.757100, (0 missing)\n      V8  < 0.9685894   to the left,  improve=2.219648, (0 missing)",
        "\n      V13 < -0.7590161  to the right, improve=1.807527, (0 missing)\n      V4  < -0.8496876  to the right, improve=1.721562, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)",
        "\n\nNode number 31: 13 observations\n  predicted class=1  expected loss=0  P(node) =0.07692308\n    class counts:     0    13\n   probabilities: 0.000 1.000 \n\nNode number 60: 13 observations\n  predicted class=0  expected loss=0.4615385  P(node) =0.07692308\n    class counts:     7     6\n   probabilities: 0.538 0.462 \n\nNode number 61: 18 observations\n  predicted class=1  expected loss=0.1111111  P(node) =0.1065089\n    class counts:     2    16\n   probabilities: 0.111 0.889 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"Classification tree for Van\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "",
        "> ",
        "van_predict <- predict(fit, van_test, type = \"class\")",
        "> ",
        "evaluation(fit, van_predict, \"response\")",
        "Error in evaluation(fit, van_predict, \"response\") : \n  could not find function \"evaluation\"\n",
        "> ",
        "library(evaluate)",
        "Error in library(evaluate) : there is no package called ‘evaluate’\n",
        "> ",
        "Harassment05 <- read.csv(file=\"Harassment0-5.csv\", header=TRUE, sep=\",\")",
        "> ",
        "k <- with(Harassment05,MASS:::kde2d(Harassment05$Longitude,Harassment05$Latitude))",
        "> ",
        "filled.contour(k)",
        "> ",
        "# width.SJ(Harassment1217$Longitude)",
        "> ",
        "n <- 1000",
        "> ",
        "k <- 11",
        "> ",
        "my.cols <- rev(brewer.pal(k, \"RdYlBu\"))",
        "Error in brewer.pal(k, \"RdYlBu\") : could not find function \"brewer.pal\"\n",
        "> ",
        "z <- kde2d(Harassment05$Longitude,Harassment05$Latitude , n=100,h = c(0.01, 0.01))",
        "Error in kde2d(Harassment05$Longitude, Harassment05$Latitude, n = 100,  : \n  could not find function \"kde2d\"\n",
        "> ",
        "",
        "> ",
        "plot(Harassment05$Longitude,Harassment05$Latitude, xlab=\"X label\", ylab=\"Y label\", pch=19, cex=.4)",
        "> ",
        "contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE)",
        "Error in contour(z, drawlabels = FALSE, nlevels = k, col = my.cols, add = TRUE) : \n  object 'z' not found\n",
        "> ",
        "smoothScatter(Harassment05$Longitude,Harassment05$Latitude, nrpoints=.3*n, colramp=colorRampPalette(my.cols), pch=19, cex=.8)",
        "Error in as.character(col) %in% \"0\" : object 'my.cols' not found\n",
        "> ",
        "library(MASS)",
        "\nAttaching package: ‘MASS’\n\n",
        "The following object is masked from ‘package:dplyr’:\n\n    select\n\n",
        "> ",
        "library(RColorBrewer)",
        "Warning message:\n",
        "package ‘RColorBrewer’ was built under R version 3.5.2 \n",
        "> ",
        "Harassment05 <- read.csv(file=\"Harassment0-5.csv\", header=TRUE, sep=\",\")",
        "> ",
        "k <- with(Harassment05,MASS:::kde2d(Harassment05$Longitude,Harassment05$Latitude))",
        "> ",
        "filled.contour(k)",
        "> ",
        "# width.SJ(Harassment1217$Longitude)",
        "> ",
        "n <- 1000",
        "> ",
        "k <- 11",
        "> ",
        "my.cols <- rev(brewer.pal(k, \"RdYlBu\"))",
        "> ",
        "z <- kde2d(Harassment05$Longitude,Harassment05$Latitude , n=100,h = c(0.01, 0.01))",
        "> ",
        "",
        "> ",
        "plot(Harassment05$Longitude,Harassment05$Latitude, xlab=\"X label\", ylab=\"Y label\", pch=19, cex=.4)",
        "> ",
        "contour(z, drawlabels=FALSE, nlevels=k, col=my.cols, add=TRUE)",
        "> ",
        "smoothScatter(Harassment05$Longitude,Harassment05$Latitude, nrpoints=.3*n, colramp=colorRampPalette(my.cols), pch=19, cex=.8)",
        "> ",
        "printcp(fit) # display the results",
        "\nClassification tree:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n\nVariables actually used in tree construction:\n[1] V11 V16 V17 V6  V7 \n\nRoot node error: 40/169 = 0.23669\n\nn= 169 \n\n      CP nsplit rel error xerror    xstd\n1 0.2375      0     1.000  1.000 0.13814\n2 0.1750      2     0.525  0.650 0.11726\n3 0.0125      3     0.350  0.475 0.10266\n4 0.0100      5     0.325  0.525 0.10721\n",
        "> ",
        "plotcp(fit) # visualize cross-validation results",
        "> ",
        "summary(fit) # detailed summary of splits",
        "Call:\nrpart(formula = V ~ ., data = van_test, method = \"class\")\n  n= 169 \n\n      CP nsplit rel error xerror      xstd\n1 0.2375      0     1.000  1.000 0.1381407\n2 0.1750      2     0.525  0.650 0.1172604\n3 0.0125      3     0.350  0.475 0.1026642\n4 0.0100      5     0.325  0.525 0.1072105\n\nVariable importance\nV11 V12  V7  V8  V4  V9 V17 V14 V16 V18  V1 V10  V6 V13  V2 \n 15  12  12  12  11   8   7   5   4   4   3   1   1   1   1 \n\nNode number 1: 169 observations,    complexity param=0.2375\n  predicted class=0  expected loss=0.2366864  P(node) =1\n    class counts:   129    40\n   probabilities: 0.763 0.237",
        " \n  left son=2 (99 obs) right son=3 (70 obs)\n  Primary splits:\n      V11 < -0.5773336  to the right, improve=20.36119, (0 missing)\n      V8  < 0.2004969   to the left,  improve=16.62064, (0 missing)\n      V12 < -0.3843474  to the right, improve=14.05478, (0 missing)\n      V4  < -0.222301   to the right, improve=13.87209, (0 missing)\n      V7  < -0.7321179  to the right, improve=13.16265, (0 missing)\n  Surrogate splits:\n      V8  < 0.2004969   to the left,  agree=0.882, adj=0.714, (0 split)\n      V12 < -0.6192186  to the right, agree=0.882, adj=0.714, (0 split)",
        "\n      V7  < -0.5516395  to the right, agree=0.876, adj=0.700, (0 split)\n      V4  < -0.4164921  to the right, agree=0.858, adj=0.657, (0 split)\n      V9  < -0.8034842  to the right, agree=0.822, adj=0.571, (0 split)\n\nNode number 2: 99 observations\n  predicted class=0  expected loss=0.03030303  P(node) =0.5857988\n    class counts:    96     3\n   probabilities: 0.970 0.030 \n\nNode number 3: 70 observations,    complexity param=0.2375\n  predicted class=1  expected loss=0.4714286  P(node) =0.4142012\n    class counts:    33    37\n   probabilities: 0.471 0.529",
        " \n  left son=6 (15 obs) right son=7 (55 obs)\n  Primary splits:\n      V17 < -1.368055   to the left,  improve=10.667530, (0 missing)\n      V6  < -0.01464306 to the left,  improve= 8.485714, (0 missing)\n      V14 < 0.9400093   to the right, improve= 8.146320, (0 missing)\n      V1  < -1.236082   to the left,  improve= 6.513245, (0 missing)\n      V18 < -1.496531   to the left,  improve= 6.513245, (0 missing)\n  Surrogate splits:\n      V14 < 0.9400093   to the right, agree=0.943, adj=0.733, (0 split)\n      V18 < -1.496531   to the left,  agree=0.914, adj=0.600, (0 split)",
        "\n      V1  < -1.357523   to the left,  agree=0.886, adj=0.467, (0 split)\n      V4  < -1.357572   to the left,  agree=0.843, adj=0.267, (0 split)\n\nNode number 6: 15 observations\n  predicted class=0  expected loss=0  P(node) =0.0887574\n    class counts:    15     0\n   probabilities: 1.000 0.000 \n\nNode number 7: 55 observations,    complexity param=0.175\n  predicted class=1  expected loss=0.3272727  P(node) =0.3254438\n    class counts:    18    37\n   probabilities: 0.327 0.673 \n  left son=14 (11 obs) right son=",
        "15 (44 obs)\n  Primary splits:\n      V16 < 0.5487154   to the right, improve=6.627273, (0 missing)\n      V10 < -0.3099288  to the left,  improve=5.313420, (0 missing)\n      V6  < -0.01464306 to the left,  improve=4.418182, (0 missing)\n      V2  < -1.355249   to the left,  improve=2.627273, (0 missing)\n      V7  < -0.4614003  to the left,  improve=2.618182, (0 missing)\n  Surrogate splits:\n      V10 < -1.54997    to the left,  agree=0.818, adj=0.091, (0 split)\n      V11 < -0.609186   to the right, agree=0.818, adj=0.091, (0 split)",
        "\n\nNode number 14: 11 observations\n  predicted class=0  expected loss=0.1818182  P(node) =0.06508876\n    class counts:     9     2\n   probabilities: 0.818 0.182 \n\nNode number 15: 44 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2045455  P(node) =0.260355\n    class counts:     9    35\n   probabilities: 0.205 0.795 \n  left son=30 (31 obs) right son=31 (13 obs)\n  Primary splits:\n      V6  < -0.01464306 to the left,  improve=1.543988, (0 missing)\n      V10 < -0.3099288  to the left,  improve=1.543445, (0 missing)",
        "\n      V4  < -0.9841276  to the right, improve=1.176570, (0 missing)\n      V7  < -0.5967591  to the left,  improve=1.082888, (0 missing)\n      V12 < -0.6192186  to the left,  improve=1.082888, (0 missing)\n  Surrogate splits:\n      V7  < -0.5967591  to the left,  agree=0.932, adj=0.769, (0 split)\n      V12 < -0.6192186  to the left,  agree=0.932, adj=0.769, (0 split)\n      V8  < 0.4565278   to the right, agree=0.909, adj=0.692, (0 split)\n      V10 < 0.03452701  to the left,  agree=0.909, adj=0.692, (0 split)",
        "\n      V9  < -0.8034842  to the left,  agree=0.886, adj=0.615, (0 split)\n\nNode number 30: 31 observations,    complexity param=0.0125\n  predicted class=1  expected loss=0.2903226  P(node) =0.183432\n    class counts:     9    22\n   probabilities: 0.290 0.710 \n  left son=60 (13 obs) right son=61 (18 obs)\n  Primary splits:\n      V7  < -0.9727557  to the right, improve=2.757100, (0 missing)\n      V12 < -0.9220043  to the right, improve=2.757100, (0 missing)\n      V8  < 0.9685894   to the left,  improve=2.219648, (0 missing)",
        "\n      V13 < -0.7590161  to the right, improve=1.807527, (0 missing)\n      V4  < -0.8496876  to the right, improve=1.721562, (0 missing)\n  Surrogate splits:\n      V12 < -0.9220043  to the right, agree=1.000, adj=1.000, (0 split)\n      V8  < 0.9685894   to the left,  agree=0.935, adj=0.846, (0 split)\n      V11 < -0.9436359  to the right, agree=0.871, adj=0.692, (0 split)\n      V13 < -0.2213237  to the right, agree=0.806, adj=0.538, (0 split)\n      V2  < -0.8690144  to the right, agree=0.774, adj=0.462, (0 split)",
        "\n\nNode number 31: 13 observations\n  predicted class=1  expected loss=0  P(node) =0.07692308\n    class counts:     0    13\n   probabilities: 0.000 1.000 \n\nNode number 60: 13 observations\n  predicted class=0  expected loss=0.4615385  P(node) =0.07692308\n    class counts:     7     6\n   probabilities: 0.538 0.462 \n\nNode number 61: 18 observations\n  predicted class=1  expected loss=0.1111111  P(node) =0.1065089\n    class counts:     2    16\n   probabilities: 0.111 0.889 \n\n",
        "> ",
        "plot(fit, uniform=TRUE,",
        "+ ",
        "     main=\"classification tree for Bus\",margin=0.05)",
        "> ",
        "text(fit, use.n=TRUE, all=TRUE, cex=.8)",
        "> ",
        "Harassment05 <- read.csv(file=\"Harassment0-5.csv\", header=TRUE, sep=\",\")",
        "> ",
        "k <- with(Harassment05,MASS:::kde2d(Harassment05$Longitude,Harassment05$Latitude))",
        "> ",
        "filled.contour(k)",
        "> ",
        "install.packages(\"MASS\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(MASS)",
        "> ",
        "install.packages(\"RColorBrewer\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(RColorBrewer)",
        "> ",
        "install.packages(\"KernSmooth\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(KernSmooth)",
        "KernSmooth 2.23 loaded\nCopyright M. P. Wand 1997-2009\n",
        "> ",
        "install.packages(\"caTools\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(caTools)",
        "> ",
        "install.packages(\"dplyr\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(dplyr)",
        "> ",
        "install.packages(\"rpart\")",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(rpart)",
        "\nRestarting R session...\n\n"
    ],
    "type" : [
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2
    ]
}